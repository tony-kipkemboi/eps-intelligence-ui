import{a as e,p as t,r as n,u as r}from"./chunk-S3R3BYOJ-4Io_U-rZ.js";import{g as i,h as a,p as o}from"./src-DKFOq3Iy.js";import{A as s,I as c,L as l,N as u,O as d,b as f,d as p,h as m,s as h,y as g}from"./chunk-ABZYJK2D-DQqi0gX5.js";import{n as _,r as v}from"./chunk-JA3XYJ7Z-lspphA4s.js";import{t as y}from"./chunk-CVBHYZKI-Bv50Qmj2.js";import{a as b,i as x,r as S,t as C}from"./chunk-ATLVNIR6-B7CO1nhh.js";function w(e,t,n){if(e&&e.length){let[r,i]=t,a=Math.PI/180*n,o=Math.cos(a),s=Math.sin(a);for(let t of e){let[e,n]=t;t[0]=(e-r)*o-(n-i)*s+r,t[1]=(e-r)*s+(n-i)*o+i}}}function T(e,t){return e[0]===t[0]&&e[1]===t[1]}function E(e,t,n,r=1){let i=n,a=Math.max(t,.1),o=e[0]&&e[0][0]&&typeof e[0][0]==`number`?[e]:e,s=[0,0];if(i)for(let e of o)w(e,s,i);let c=function(e,t,n){let r=[];for(let t of e){let e=[...t];T(e[0],e[e.length-1])||e.push([e[0][0],e[0][1]]),e.length>2&&r.push(e)}let i=[];t=Math.max(t,.1);let a=[];for(let e of r)for(let t=0;t<e.length-1;t++){let n=e[t],r=e[t+1];if(n[1]!==r[1]){let e=Math.min(n[1],r[1]);a.push({ymin:e,ymax:Math.max(n[1],r[1]),x:e===n[1]?n[0]:r[0],islope:(r[0]-n[0])/(r[1]-n[1])})}}if(a.sort(((e,t)=>e.ymin<t.ymin?-1:e.ymin>t.ymin?1:e.x<t.x?-1:e.x>t.x?1:e.ymax===t.ymax?0:(e.ymax-t.ymax)/Math.abs(e.ymax-t.ymax))),!a.length)return i;let o=[],s=a[0].ymin,c=0;for(;o.length||a.length;){if(a.length){let e=-1;for(let t=0;t<a.length&&!(a[t].ymin>s);t++)e=t;a.splice(0,e+1).forEach((e=>{o.push({s,edge:e})}))}if(o=o.filter((e=>!(e.edge.ymax<=s))),o.sort(((e,t)=>e.edge.x===t.edge.x?0:(e.edge.x-t.edge.x)/Math.abs(e.edge.x-t.edge.x))),(n!==1||c%t==0)&&o.length>1)for(let e=0;e<o.length;e+=2){let t=e+1;if(t>=o.length)break;let n=o[e].edge,r=o[t].edge;i.push([[Math.round(n.x),s],[Math.round(r.x),s]])}s+=n,o.forEach((e=>{e.edge.x=e.edge.x+n*e.edge.islope})),c++}return i}(o,a,r);if(i){for(let e of o)w(e,s,-i);(function(e,t,n){let r=[];e.forEach((e=>r.push(...e))),w(r,t,n)})(c,s,-i)}return c}function D(e,t){let n=t.hachureAngle+90,r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.round(Math.max(r,.1));let i=1;return t.roughness>=1&&(t.randomizer?.next()||Math.random())>.7&&(i=r),E(e,r,n,i||1)}var O=class{constructor(e){this.helper=e}fillPolygons(e,t){return this._fillPolygons(e,t)}_fillPolygons(e,t){let n=D(e,t);return{type:`fillSketch`,ops:this.renderLines(n,t)}}renderLines(e,t){let n=[];for(let r of e)n.push(...this.helper.doubleLineOps(r[0][0],r[0][1],r[1][0],r[1][1],t));return n}};function k(e){let t=e[0],n=e[1];return Math.sqrt((t[0]-n[0])**2+(t[1]-n[1])**2)}var A=class extends O{fillPolygons(e,t){let n=t.hachureGap;n<0&&(n=4*t.strokeWidth),n=Math.max(n,.1);let r=D(e,Object.assign({},t,{hachureGap:n})),i=Math.PI/180*t.hachureAngle,a=[],o=.5*n*Math.cos(i),s=.5*n*Math.sin(i);for(let[e,t]of r)k([e,t])&&a.push([[e[0]-o,e[1]+s],[...t]],[[e[0]+o,e[1]-s],[...t]]);return{type:`fillSketch`,ops:this.renderLines(a,t)}}},j=class extends O{fillPolygons(e,t){let n=this._fillPolygons(e,t),r=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),i=this._fillPolygons(e,r);return n.ops=n.ops.concat(i.ops),n}},M=class{constructor(e){this.helper=e}fillPolygons(e,t){let n=D(e,t=Object.assign({},t,{hachureAngle:0}));return this.dotsOnLines(n,t)}dotsOnLines(e,t){let n=[],r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);let i=t.fillWeight;i<0&&(i=t.strokeWidth/2);let a=r/4;for(let o of e){let e=k(o),s=e/r,c=Math.ceil(s)-1,l=e-c*r,u=(o[0][0]+o[1][0])/2-r/4,d=Math.min(o[0][1],o[1][1]);for(let e=0;e<c;e++){let o=d+l+e*r,s=u-a+2*Math.random()*a,c=o-a+2*Math.random()*a,f=this.helper.ellipse(s,c,i,i,t);n.push(...f.ops)}}return{type:`fillSketch`,ops:n}}},N=class{constructor(e){this.helper=e}fillPolygons(e,t){let n=D(e,t);return{type:`fillSketch`,ops:this.dashedLine(n,t)}}dashedLine(e,t){let n=t.dashOffset<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashOffset,r=t.dashGap<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashGap,i=[];return e.forEach((e=>{let a=k(e),o=Math.floor(a/(n+r)),s=(a+r-o*(n+r))/2,c=e[0],l=e[1];c[0]>l[0]&&(c=e[1],l=e[0]);let u=Math.atan((l[1]-c[1])/(l[0]-c[0]));for(let e=0;e<o;e++){let a=e*(n+r),o=a+n,l=[c[0]+a*Math.cos(u)+s*Math.cos(u),c[1]+a*Math.sin(u)+s*Math.sin(u)],d=[c[0]+o*Math.cos(u)+s*Math.cos(u),c[1]+o*Math.sin(u)+s*Math.sin(u)];i.push(...this.helper.doubleLineOps(l[0],l[1],d[0],d[1],t))}})),i}},P=class{constructor(e){this.helper=e}fillPolygons(e,t){let n=t.hachureGap<0?4*t.strokeWidth:t.hachureGap,r=t.zigzagOffset<0?n:t.zigzagOffset,i=D(e,t=Object.assign({},t,{hachureGap:n+r}));return{type:`fillSketch`,ops:this.zigzagLines(i,r,t)}}zigzagLines(e,t,n){let r=[];return e.forEach((e=>{let i=k(e),a=Math.round(i/(2*t)),o=e[0],s=e[1];o[0]>s[0]&&(o=e[1],s=e[0]);let c=Math.atan((s[1]-o[1])/(s[0]-o[0]));for(let e=0;e<a;e++){let i=2*e*t,a=2*(e+1)*t,s=Math.sqrt(2*t**2),l=[o[0]+i*Math.cos(c),o[1]+i*Math.sin(c)],u=[o[0]+a*Math.cos(c),o[1]+a*Math.sin(c)],d=[l[0]+s*Math.cos(c+Math.PI/4),l[1]+s*Math.sin(c+Math.PI/4)];r.push(...this.helper.doubleLineOps(l[0],l[1],d[0],d[1],n),...this.helper.doubleLineOps(d[0],d[1],u[0],u[1],n))}})),r}},F={},I=class{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},ee=0,te=1,ne=2,re={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function ie(e,t){return e.type===t}function ae(e){let t=[],n=function(e){let t=[];for(;e!==``;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:ee,text:RegExp.$1},e=e.substr(RegExp.$1.length);else{if(!e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];t[t.length]={type:te,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length)}return t[t.length]={type:ne,text:``},t}(e),r=`BOD`,i=0,a=n[i];for(;!ie(a,ne);){let o=0,s=[];if(r===`BOD`){if(a.text!==`M`&&a.text!==`m`)return ae(`M0,0`+e);i++,o=re[a.text],r=a.text}else ie(a,te)?o=re[r]:(i++,o=re[a.text],r=a.text);if(!(i+o<n.length))throw Error(`Path data ended short`);for(let e=i;e<i+o;e++){let t=n[e];if(!ie(t,te))throw Error(`Param not a number: `+r+`,`+t.text);s[s.length]=+t.text}if(typeof re[r]!=`number`)throw Error(`Bad segment: `+r);{let e={key:r,data:s};t.push(e),i+=o,a=n[i],r===`M`&&(r=`L`),r===`m`&&(r=`l`)}}return t}function L(e){let t=0,n=0,r=0,i=0,a=[];for(let{key:o,data:s}of e)switch(o){case`M`:a.push({key:`M`,data:[...s]}),[t,n]=s,[r,i]=s;break;case`m`:t+=s[0],n+=s[1],a.push({key:`M`,data:[t,n]}),r=t,i=n;break;case`L`:a.push({key:`L`,data:[...s]}),[t,n]=s;break;case`l`:t+=s[0],n+=s[1],a.push({key:`L`,data:[t,n]});break;case`C`:a.push({key:`C`,data:[...s]}),t=s[4],n=s[5];break;case`c`:{let e=s.map(((e,r)=>r%2?e+n:e+t));a.push({key:`C`,data:e}),t=e[4],n=e[5];break}case`Q`:a.push({key:`Q`,data:[...s]}),t=s[2],n=s[3];break;case`q`:{let e=s.map(((e,r)=>r%2?e+n:e+t));a.push({key:`Q`,data:e}),t=e[2],n=e[3];break}case`A`:a.push({key:`A`,data:[...s]}),t=s[5],n=s[6];break;case`a`:t+=s[5],n+=s[6],a.push({key:`A`,data:[s[0],s[1],s[2],s[3],s[4],t,n]});break;case`H`:a.push({key:`H`,data:[...s]}),t=s[0];break;case`h`:t+=s[0],a.push({key:`H`,data:[t]});break;case`V`:a.push({key:`V`,data:[...s]}),n=s[0];break;case`v`:n+=s[0],a.push({key:`V`,data:[n]});break;case`S`:a.push({key:`S`,data:[...s]}),t=s[2],n=s[3];break;case`s`:{let e=s.map(((e,r)=>r%2?e+n:e+t));a.push({key:`S`,data:e}),t=e[2],n=e[3];break}case`T`:a.push({key:`T`,data:[...s]}),t=s[0],n=s[1];break;case`t`:t+=s[0],n+=s[1],a.push({key:`T`,data:[t,n]});break;case`Z`:case`z`:a.push({key:`Z`,data:[]}),t=r,n=i}return a}function oe(e){let t=[],n=``,r=0,i=0,a=0,o=0,s=0,c=0;for(let{key:l,data:u}of e){switch(l){case`M`:t.push({key:`M`,data:[...u]}),[r,i]=u,[a,o]=u;break;case`C`:t.push({key:`C`,data:[...u]}),r=u[4],i=u[5],s=u[2],c=u[3];break;case`L`:t.push({key:`L`,data:[...u]}),[r,i]=u;break;case`H`:r=u[0],t.push({key:`L`,data:[r,i]});break;case`V`:i=u[0],t.push({key:`L`,data:[r,i]});break;case`S`:{let e=0,a=0;n===`C`||n===`S`?(e=r+(r-s),a=i+(i-c)):(e=r,a=i),t.push({key:`C`,data:[e,a,...u]}),s=u[0],c=u[1],r=u[2],i=u[3];break}case`T`:{let[e,a]=u,o=0,l=0;n===`Q`||n===`T`?(o=r+(r-s),l=i+(i-c)):(o=r,l=i);let d=r+2*(o-r)/3,f=i+2*(l-i)/3,p=e+2*(o-e)/3,m=a+2*(l-a)/3;t.push({key:`C`,data:[d,f,p,m,e,a]}),s=o,c=l,r=e,i=a;break}case`Q`:{let[e,n,a,o]=u,l=r+2*(e-r)/3,d=i+2*(n-i)/3,f=a+2*(e-a)/3,p=o+2*(n-o)/3;t.push({key:`C`,data:[l,d,f,p,a,o]}),s=e,c=n,r=a,i=o;break}case`A`:{let e=Math.abs(u[0]),n=Math.abs(u[1]),a=u[2],o=u[3],s=u[4],c=u[5],l=u[6];e===0||n===0?(t.push({key:`C`,data:[r,i,c,l,c,l]}),r=c,i=l):(r!==c||i!==l)&&(ce(r,i,c,l,e,n,a,o,s).forEach((function(e){t.push({key:`C`,data:e})})),r=c,i=l);break}case`Z`:t.push({key:`Z`,data:[]}),r=a,i=o}n=l}return t}function se(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function ce(e,t,n,r,i,a,o,s,c,l){let u=(d=o,Math.PI*d/180);var d;let f=[],p=0,m=0,h=0,g=0;if(l)[p,m,h,g]=l;else{[e,t]=se(e,t,-u),[n,r]=se(n,r,-u);let o=(e-n)/2,l=(t-r)/2,d=o*o/(i*i)+l*l/(a*a);d>1&&(d=Math.sqrt(d),i*=d,a*=d);let f=i*i,_=a*a,v=f*_-f*l*l-_*o*o,y=f*l*l+_*o*o,b=(s===c?-1:1)*Math.sqrt(Math.abs(v/y));h=b*i*l/a+(e+n)/2,g=b*-a*o/i+(t+r)/2,p=Math.asin(parseFloat(((t-g)/a).toFixed(9))),m=Math.asin(parseFloat(((r-g)/a).toFixed(9))),e<h&&(p=Math.PI-p),n<h&&(m=Math.PI-m),p<0&&(p=2*Math.PI+p),m<0&&(m=2*Math.PI+m),c&&p>m&&(p-=2*Math.PI),!c&&m>p&&(m-=2*Math.PI)}let _=m-p;if(Math.abs(_)>120*Math.PI/180){let e=m,t=n,s=r;m=c&&m>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,f=ce(n=h+i*Math.cos(m),r=g+a*Math.sin(m),t,s,i,a,o,0,c,[m,e,h,g])}_=m-p;let v=Math.cos(p),y=Math.sin(p),b=Math.cos(m),x=Math.sin(m),S=Math.tan(_/4),C=4/3*i*S,w=4/3*a*S,T=[e,t],E=[e+C*y,t-w*v],D=[n+C*x,r-w*b],O=[n,r];if(E[0]=2*T[0]-E[0],E[1]=2*T[1]-E[1],l)return[E,D,O].concat(f);{f=[E,D,O].concat(f);let e=[];for(let t=0;t<f.length;t+=3){let n=se(f[t][0],f[t][1],u),r=se(f[t+1][0],f[t+1][1],u),i=se(f[t+2][0],f[t+2][1],u);e.push([n[0],n[1],r[0],r[1],i[0],i[1]])}return e}}var le={randOffset:function(e,t){return R(e,t)},randOffsetWithRange:function(e,t,n){return Se(e,t,n)},ellipse:function(e,t,n,r,i){return he(e,t,i,me(n,r,i)).opset},doubleLineOps:function(e,t,n,r,i){return z(e,t,n,r,i,!0)}};function ue(e,t,n,r,i){return{type:`path`,ops:z(e,t,n,r,i)}}function de(e,t,n){let r=(e||[]).length;if(r>2){let i=[];for(let t=0;t<r-1;t++)i.push(...z(e[t][0],e[t][1],e[t+1][0],e[t+1][1],n));return t&&i.push(...z(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:`path`,ops:i}}return r===2?ue(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:`path`,ops:[]}}function fe(e,t,n,r,i){return function(e,t){return de(e,!0,t)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],i)}function pe(e,t){if(e.length){let n=typeof e[0][0]==`number`?[e]:e,r=we(n[0],1*(1+.2*t.roughness),t),i=t.disableMultiStroke?[]:we(n[0],1.5*(1+.22*t.roughness),be(t));for(let e=1;e<n.length;e++){let a=n[e];if(a.length){let e=we(a,1*(1+.2*t.roughness),t),n=t.disableMultiStroke?[]:we(a,1.5*(1+.22*t.roughness),be(t));for(let t of e)t.op!==`move`&&r.push(t);for(let e of n)e.op!==`move`&&i.push(e)}}return{type:`path`,ops:r.concat(i)}}return{type:`path`,ops:[]}}function me(e,t,n){let r=Math.sqrt(2*Math.PI*Math.sqrt(((e/2)**2+(t/2)**2)/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),a=2*Math.PI/i,o=Math.abs(e/2),s=Math.abs(t/2),c=1-n.curveFitting;return o+=R(o*c,n),s+=R(s*c,n),{increment:a,rx:o,ry:s}}function he(e,t,n,r){let[i,a]=Ee(r.increment,e,t,r.rx,r.ry,1,r.increment*Se(.1,Se(.4,1,n),n),n),o=Te(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){let[i]=Ee(r.increment,e,t,r.rx,r.ry,1.5,0,n),a=Te(i,null,n);o=o.concat(a)}return{estimatedPoints:a,opset:{type:`path`,ops:o}}}function ge(e,t,n,r,i,a,o,s,c){let l=e,u=t,d=Math.abs(n/2),f=Math.abs(r/2);d+=R(.01*d,c),f+=R(.01*f,c);let p=i,m=a;for(;p<0;)p+=2*Math.PI,m+=2*Math.PI;m-p>2*Math.PI&&(p=0,m=2*Math.PI);let h=2*Math.PI/c.curveStepCount,g=Math.min(h/2,(m-p)/2),_=De(g,l,u,d,f,p,m,1,c);if(!c.disableMultiStroke){let e=De(g,l,u,d,f,p,m,1.5,c);_.push(...e)}return o&&(s?_.push(...z(l,u,l+d*Math.cos(p),u+f*Math.sin(p),c),...z(l,u,l+d*Math.cos(m),u+f*Math.sin(m),c)):_.push({op:`lineTo`,data:[l,u]},{op:`lineTo`,data:[l+d*Math.cos(p),u+f*Math.sin(p)]})),{type:`path`,ops:_}}function _e(e,t){let n=oe(L(ae(e))),r=[],i=[0,0],a=[0,0];for(let{key:e,data:o}of n)switch(e){case`M`:a=[o[0],o[1]],i=[o[0],o[1]];break;case`L`:r.push(...z(a[0],a[1],o[0],o[1],t)),a=[o[0],o[1]];break;case`C`:{let[e,n,i,s,c,l]=o;r.push(...Oe(e,n,i,s,c,l,a,t)),a=[c,l];break}case`Z`:r.push(...z(a[0],a[1],i[0],i[1],t)),a=[i[0],i[1]]}return{type:`path`,ops:r}}function ve(e,t){let n=[];for(let r of e)if(r.length){let e=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:`move`,data:[r[0][0]+R(e,t),r[0][1]+R(e,t)]});for(let a=1;a<i;a++)n.push({op:`lineTo`,data:[r[a][0]+R(e,t),r[a][1]+R(e,t)]})}}return{type:`fillPath`,ops:n}}function ye(e,t){return function(e,t){let n=e.fillStyle||`hachure`;if(!F[n])switch(n){case`zigzag`:F[n]||(F[n]=new A(t));break;case`cross-hatch`:F[n]||(F[n]=new j(t));break;case`dots`:F[n]||(F[n]=new M(t));break;case`dashed`:F[n]||(F[n]=new N(t));break;case`zigzag-line`:F[n]||(F[n]=new P(t));break;default:n=`hachure`,F[n]||(F[n]=new O(t))}return F[n]}(t,le).fillPolygons(e,t)}function be(e){let t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function xe(e){return e.randomizer||=new I(e.seed||0),e.randomizer.next()}function Se(e,t,n,r=1){return n.roughness*r*(xe(n)*(t-e)+e)}function R(e,t,n=1){return Se(-e,e,t,n)}function z(e,t,n,r,i,a=!1){let o=a?i.disableMultiStrokeFill:i.disableMultiStroke,s=Ce(e,t,n,r,i,!0,!1);if(o)return s;let c=Ce(e,t,n,r,i,!0,!0);return s.concat(c)}function Ce(e,t,n,r,i,a,o){let s=(e-n)**2+(t-r)**2,c=Math.sqrt(s),l=1;l=c<200?1:c>500?.4:-.0016668*c+1.233334;let u=i.maxRandomnessOffset||0;u*u*100>s&&(u=c/10);let d=u/2,f=.2+.2*xe(i),p=i.bowing*i.maxRandomnessOffset*(r-t)/200,m=i.bowing*i.maxRandomnessOffset*(e-n)/200;p=R(p,i,l),m=R(m,i,l);let h=[],g=()=>R(d,i,l),_=()=>R(u,i,l),v=i.preserveVertices;return a&&(o?h.push({op:`move`,data:[e+(v?0:g()),t+(v?0:g())]}):h.push({op:`move`,data:[e+(v?0:R(u,i,l)),t+(v?0:R(u,i,l))]})),o?h.push({op:`bcurveTo`,data:[p+e+(n-e)*f+g(),m+t+(r-t)*f+g(),p+e+2*(n-e)*f+g(),m+t+2*(r-t)*f+g(),n+(v?0:g()),r+(v?0:g())]}):h.push({op:`bcurveTo`,data:[p+e+(n-e)*f+_(),m+t+(r-t)*f+_(),p+e+2*(n-e)*f+_(),m+t+2*(r-t)*f+_(),n+(v?0:_()),r+(v?0:_())]}),h}function we(e,t,n){if(!e.length)return[];let r=[];r.push([e[0][0]+R(t,n),e[0][1]+R(t,n)]),r.push([e[0][0]+R(t,n),e[0][1]+R(t,n)]);for(let i=1;i<e.length;i++)r.push([e[i][0]+R(t,n),e[i][1]+R(t,n)]),i===e.length-1&&r.push([e[i][0]+R(t,n),e[i][1]+R(t,n)]);return Te(r,null,n)}function Te(e,t,n){let r=e.length,i=[];if(r>3){let a=[],o=1-n.curveTightness;i.push({op:`move`,data:[e[1][0],e[1][1]]});for(let t=1;t+2<r;t++){let n=e[t];a[0]=[n[0],n[1]],a[1]=[n[0]+(o*e[t+1][0]-o*e[t-1][0])/6,n[1]+(o*e[t+1][1]-o*e[t-1][1])/6],a[2]=[e[t+1][0]+(o*e[t][0]-o*e[t+2][0])/6,e[t+1][1]+(o*e[t][1]-o*e[t+2][1])/6],a[3]=[e[t+1][0],e[t+1][1]],i.push({op:`bcurveTo`,data:[a[1][0],a[1][1],a[2][0],a[2][1],a[3][0],a[3][1]]})}if(t&&t.length===2){let e=n.maxRandomnessOffset;i.push({op:`lineTo`,data:[t[0]+R(e,n),t[1]+R(e,n)]})}}else r===3?(i.push({op:`move`,data:[e[1][0],e[1][1]]}),i.push({op:`bcurveTo`,data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&i.push(...Ce(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return i}function Ee(e,t,n,r,i,a,o,s){let c=[],l=[];if(s.roughness===0){e/=4,l.push([t+r*Math.cos(-e),n+i*Math.sin(-e)]);for(let a=0;a<=2*Math.PI;a+=e){let e=[t+r*Math.cos(a),n+i*Math.sin(a)];c.push(e),l.push(e)}l.push([t+r*Math.cos(0),n+i*Math.sin(0)]),l.push([t+r*Math.cos(e),n+i*Math.sin(e)])}else{let u=R(.5,s)-Math.PI/2;l.push([R(a,s)+t+.9*r*Math.cos(u-e),R(a,s)+n+.9*i*Math.sin(u-e)]);let d=2*Math.PI+u-.01;for(let o=u;o<d;o+=e){let e=[R(a,s)+t+r*Math.cos(o),R(a,s)+n+i*Math.sin(o)];c.push(e),l.push(e)}l.push([R(a,s)+t+r*Math.cos(u+2*Math.PI+.5*o),R(a,s)+n+i*Math.sin(u+2*Math.PI+.5*o)]),l.push([R(a,s)+t+.98*r*Math.cos(u+o),R(a,s)+n+.98*i*Math.sin(u+o)]),l.push([R(a,s)+t+.9*r*Math.cos(u+.5*o),R(a,s)+n+.9*i*Math.sin(u+.5*o)])}return[l,c]}function De(e,t,n,r,i,a,o,s,c){let l=a+R(.1,c),u=[];u.push([R(s,c)+t+.9*r*Math.cos(l-e),R(s,c)+n+.9*i*Math.sin(l-e)]);for(let a=l;a<=o;a+=e)u.push([R(s,c)+t+r*Math.cos(a),R(s,c)+n+i*Math.sin(a)]);return u.push([t+r*Math.cos(o),n+i*Math.sin(o)]),u.push([t+r*Math.cos(o),n+i*Math.sin(o)]),Te(u,null,c)}function Oe(e,t,n,r,i,a,o,s){let c=[],l=[s.maxRandomnessOffset||1,(s.maxRandomnessOffset||1)+.3],u=[0,0],d=s.disableMultiStroke?1:2,f=s.preserveVertices;for(let p=0;p<d;p++)p===0?c.push({op:`move`,data:[o[0],o[1]]}):c.push({op:`move`,data:[o[0]+(f?0:R(l[0],s)),o[1]+(f?0:R(l[0],s))]}),u=f?[i,a]:[i+R(l[p],s),a+R(l[p],s)],c.push({op:`bcurveTo`,data:[e+R(l[p],s),t+R(l[p],s),n+R(l[p],s),r+R(l[p],s),u[0],u[1]]});return c}function ke(e){return[...e]}function Ae(e,t=0){let n=e.length;if(n<3)throw Error(`A curve must have at least three points.`);let r=[];if(n===3)r.push(ke(e[0]),ke(e[1]),ke(e[2]),ke(e[2]));else{let n=[];n.push(e[0],e[0]);for(let t=1;t<e.length;t++)n.push(e[t]),t===e.length-1&&n.push(e[t]);let i=[],a=1-t;r.push(ke(n[0]));for(let e=1;e+2<n.length;e++){let t=n[e];i[0]=[t[0],t[1]],i[1]=[t[0]+(a*n[e+1][0]-a*n[e-1][0])/6,t[1]+(a*n[e+1][1]-a*n[e-1][1])/6],i[2]=[n[e+1][0]+(a*n[e][0]-a*n[e+2][0])/6,n[e+1][1]+(a*n[e][1]-a*n[e+2][1])/6],i[3]=[n[e+1][0],n[e+1][1]],r.push(i[1],i[2],i[3])}}return r}function je(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2}function Me(e,t,n){let r=je(t,n);if(r===0)return je(e,t);let i=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return i=Math.max(0,Math.min(1,i)),je(e,Ne(t,n,i))}function Ne(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function Pe(e,t,n,r){let i=r||[];if(function(e,t){let n=e[t+0],r=e[t+1],i=e[t+2],a=e[t+3],o=3*r[0]-2*n[0]-a[0];o*=o;let s=3*r[1]-2*n[1]-a[1];s*=s;let c=3*i[0]-2*a[0]-n[0];c*=c;let l=3*i[1]-2*a[1]-n[1];return l*=l,o<c&&(o=c),s<l&&(s=l),o+s}(e,t)<n){let n=e[t+0];i.length?(a=i[i.length-1],o=n,Math.sqrt(je(a,o)))>1&&i.push(n):i.push(n),i.push(e[t+3])}else{let r=.5,a=e[t+0],o=e[t+1],s=e[t+2],c=e[t+3],l=Ne(a,o,r),u=Ne(o,s,r),d=Ne(s,c,r),f=Ne(l,u,r),p=Ne(u,d,r),m=Ne(f,p,r);Pe([a,l,f,m],0,n,i),Pe([m,p,d,c],0,n,i)}var a,o;return i}function Fe(e,t){return Ie(e,0,e.length,t)}function Ie(e,t,n,r,i){let a=i||[],o=e[t],s=e[n-1],c=0,l=1;for(let r=t+1;r<n-1;++r){let t=Me(e[r],o,s);t>c&&(c=t,l=r)}return Math.sqrt(c)>r?(Ie(e,t,l+1,r,a),Ie(e,l,n,r,a)):(a.length||a.push(o),a.push(s)),a}function Le(e,t=.15,n){let r=[],i=(e.length-1)/3;for(let n=0;n<i;n++)Pe(e,3*n,t,r);return n&&n>0?Ie(r,0,r.length,n):r}var B=`none`,Re=class{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:`#000`,strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:`hachure`,fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,t,n){return{shape:e,sets:t||[],options:n||this.defaultOptions}}line(e,t,n,r,i){let a=this._o(i);return this._d(`line`,[ue(e,t,n,r,a)],a)}rectangle(e,t,n,r,i){let a=this._o(i),o=[],s=fe(e,t,n,r,a);if(a.fill){let i=[[e,t],[e+n,t],[e+n,t+r],[e,t+r]];a.fillStyle===`solid`?o.push(ve([i],a)):o.push(ye([i],a))}return a.stroke!==B&&o.push(s),this._d(`rectangle`,o,a)}ellipse(e,t,n,r,i){let a=this._o(i),o=[],s=me(n,r,a),c=he(e,t,a,s);if(a.fill)if(a.fillStyle===`solid`){let n=he(e,t,a,s).opset;n.type=`fillPath`,o.push(n)}else o.push(ye([c.estimatedPoints],a));return a.stroke!==B&&o.push(c.opset),this._d(`ellipse`,o,a)}circle(e,t,n,r){let i=this.ellipse(e,t,n,n,r);return i.shape=`circle`,i}linearPath(e,t){let n=this._o(t);return this._d(`linearPath`,[de(e,!1,n)],n)}arc(e,t,n,r,i,a,o=!1,s){let c=this._o(s),l=[],u=ge(e,t,n,r,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle===`solid`){let o=Object.assign({},c);o.disableMultiStroke=!0;let s=ge(e,t,n,r,i,a,!0,!1,o);s.type=`fillPath`,l.push(s)}else l.push(function(e,t,n,r,i,a,o){let s=e,c=t,l=Math.abs(n/2),u=Math.abs(r/2);l+=R(.01*l,o),u+=R(.01*u,o);let d=i,f=a;for(;d<0;)d+=2*Math.PI,f+=2*Math.PI;f-d>2*Math.PI&&(d=0,f=2*Math.PI);let p=(f-d)/o.curveStepCount,m=[];for(let e=d;e<=f;e+=p)m.push([s+l*Math.cos(e),c+u*Math.sin(e)]);return m.push([s+l*Math.cos(f),c+u*Math.sin(f)]),m.push([s,c]),ye([m],o)}(e,t,n,r,i,a,c));return c.stroke!==B&&l.push(u),this._d(`arc`,l,c)}curve(e,t){let n=this._o(t),r=[],i=pe(e,n);if(n.fill&&n.fill!==B)if(n.fillStyle===`solid`){let t=pe(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));r.push({type:`fillPath`,ops:this._mergedShape(t.ops)})}else{let t=[],i=e;if(i.length){let e=typeof i[0][0]==`number`?[i]:i;for(let r of e)r.length<3?t.push(...r):r.length===3?t.push(...Le(Ae([r[0],r[0],r[1],r[2]]),10,(1+n.roughness)/2)):t.push(...Le(Ae(r),10,(1+n.roughness)/2))}t.length&&r.push(ye([t],n))}return n.stroke!==B&&r.push(i),this._d(`curve`,r,n)}polygon(e,t){let n=this._o(t),r=[],i=de(e,!0,n);return n.fill&&(n.fillStyle===`solid`?r.push(ve([e],n)):r.push(ye([e],n))),n.stroke!==B&&r.push(i),this._d(`polygon`,r,n)}path(e,t){let n=this._o(t),r=[];if(!e)return this._d(`path`,r,n);e=(e||``).replace(/\n/g,` `).replace(/(-\s)/g,`-`).replace(`/(ss)/g`,` `);let i=n.fill&&n.fill!==`transparent`&&n.fill!==B,a=n.stroke!==B,o=!!(n.simplification&&n.simplification<1),s=function(e,t,n){let r=oe(L(ae(e))),i=[],a=[],o=[0,0],s=[],c=()=>{s.length>=4&&a.push(...Le(s,t)),s=[]},l=()=>{c(),a.length&&(i.push(a),a=[])};for(let{key:e,data:t}of r)switch(e){case`M`:l(),o=[t[0],t[1]],a.push(o);break;case`L`:c(),a.push([t[0],t[1]]);break;case`C`:if(!s.length){let e=a.length?a[a.length-1]:o;s.push([e[0],e[1]])}s.push([t[0],t[1]]),s.push([t[2],t[3]]),s.push([t[4],t[5]]);break;case`Z`:c(),a.push([o[0],o[1]])}if(l(),!n)return i;let u=[];for(let e of i){let t=Fe(e,n);t.length&&u.push(t)}return u}(e,1,o?4-4*(n.simplification||1):(1+n.roughness)/2),c=_e(e,n);if(i)if(n.fillStyle===`solid`)if(s.length===1){let t=_e(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));r.push({type:`fillPath`,ops:this._mergedShape(t.ops)})}else r.push(ve(s,n));else r.push(ye(s,n));return a&&(o?s.forEach((e=>{r.push(de(e,!1,n))})):r.push(c)),this._d(`path`,r,n)}opsToPath(e,t){let n=``;for(let r of e.ops){let e=typeof t==`number`&&t>=0?r.data.map((e=>+e.toFixed(t))):r.data;switch(r.op){case`move`:n+=`M${e[0]} ${e[1]} `;break;case`bcurveTo`:n+=`C${e[0]} ${e[1]}, ${e[2]} ${e[3]}, ${e[4]} ${e[5]} `;break;case`lineTo`:n+=`L${e[0]} ${e[1]} `}}return n.trim()}toPaths(e){let t=e.sets||[],n=e.options||this.defaultOptions,r=[];for(let e of t){let t=null;switch(e.type){case`path`:t={d:this.opsToPath(e),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:B};break;case`fillPath`:t={d:this.opsToPath(e),stroke:B,strokeWidth:0,fill:n.fill||B};break;case`fillSketch`:t=this.fillSketch(e,n)}t&&r.push(t)}return r}fillSketch(e,t){let n=t.fillWeight;return n<0&&(n=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||B,strokeWidth:n,fill:B}}_mergedShape(e){return e.filter(((e,t)=>t===0||e.op!==`move`))}},ze=class{constructor(e,t){this.canvas=e,this.ctx=this.canvas.getContext(`2d`),this.gen=new Re(t)}draw(e){let t=e.sets||[],n=e.options||this.getDefaultOptions(),r=this.ctx,i=e.options.fixedDecimalPlaceDigits;for(let a of t)switch(a.type){case`path`:r.save(),r.strokeStyle=n.stroke===`none`?`transparent`:n.stroke,r.lineWidth=n.strokeWidth,n.strokeLineDash&&r.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(r.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(r,a,i),r.restore();break;case`fillPath`:{r.save(),r.fillStyle=n.fill||``;let t=e.shape===`curve`||e.shape===`polygon`||e.shape===`path`?`evenodd`:`nonzero`;this._drawToContext(r,a,i,t),r.restore();break}case`fillSketch`:this.fillSketch(r,a,n)}}fillSketch(e,t,n){let r=n.fillWeight;r<0&&(r=n.strokeWidth/2),e.save(),n.fillLineDash&&e.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(e.lineDashOffset=n.fillLineDashOffset),e.strokeStyle=n.fill||``,e.lineWidth=r,this._drawToContext(e,t,n.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,t,n,r=`nonzero`){e.beginPath();for(let r of t.ops){let t=typeof n==`number`&&n>=0?r.data.map((e=>+e.toFixed(n))):r.data;switch(r.op){case`move`:e.moveTo(t[0],t[1]);break;case`bcurveTo`:e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]);break;case`lineTo`:e.lineTo(t[0],t[1])}}t.type===`fillPath`?e.fill(r):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,t,n,r,i){let a=this.gen.line(e,t,n,r,i);return this.draw(a),a}rectangle(e,t,n,r,i){let a=this.gen.rectangle(e,t,n,r,i);return this.draw(a),a}ellipse(e,t,n,r,i){let a=this.gen.ellipse(e,t,n,r,i);return this.draw(a),a}circle(e,t,n,r){let i=this.gen.circle(e,t,n,r);return this.draw(i),i}linearPath(e,t){let n=this.gen.linearPath(e,t);return this.draw(n),n}polygon(e,t){let n=this.gen.polygon(e,t);return this.draw(n),n}arc(e,t,n,r,i,a,o=!1,s){let c=this.gen.arc(e,t,n,r,i,a,o,s);return this.draw(c),c}curve(e,t){let n=this.gen.curve(e,t);return this.draw(n),n}path(e,t){let n=this.gen.path(e,t);return this.draw(n),n}},Be=`http://www.w3.org/2000/svg`,Ve=class{constructor(e,t){this.svg=e,this.gen=new Re(t)}draw(e){let t=e.sets||[],n=e.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,i=r.createElementNS(Be,`g`),a=e.options.fixedDecimalPlaceDigits;for(let o of t){let t=null;switch(o.type){case`path`:t=r.createElementNS(Be,`path`),t.setAttribute(`d`,this.opsToPath(o,a)),t.setAttribute(`stroke`,n.stroke),t.setAttribute(`stroke-width`,n.strokeWidth+``),t.setAttribute(`fill`,`none`),n.strokeLineDash&&t.setAttribute(`stroke-dasharray`,n.strokeLineDash.join(` `).trim()),n.strokeLineDashOffset&&t.setAttribute(`stroke-dashoffset`,`${n.strokeLineDashOffset}`);break;case`fillPath`:t=r.createElementNS(Be,`path`),t.setAttribute(`d`,this.opsToPath(o,a)),t.setAttribute(`stroke`,`none`),t.setAttribute(`stroke-width`,`0`),t.setAttribute(`fill`,n.fill||``),e.shape!==`curve`&&e.shape!==`polygon`||t.setAttribute(`fill-rule`,`evenodd`);break;case`fillSketch`:t=this.fillSketch(r,o,n)}t&&i.appendChild(t)}return i}fillSketch(e,t,n){let r=n.fillWeight;r<0&&(r=n.strokeWidth/2);let i=e.createElementNS(Be,`path`);return i.setAttribute(`d`,this.opsToPath(t,n.fixedDecimalPlaceDigits)),i.setAttribute(`stroke`,n.fill||``),i.setAttribute(`stroke-width`,r+``),i.setAttribute(`fill`,`none`),n.fillLineDash&&i.setAttribute(`stroke-dasharray`,n.fillLineDash.join(` `).trim()),n.fillLineDashOffset&&i.setAttribute(`stroke-dashoffset`,`${n.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,t){return this.gen.opsToPath(e,t)}line(e,t,n,r,i){let a=this.gen.line(e,t,n,r,i);return this.draw(a)}rectangle(e,t,n,r,i){let a=this.gen.rectangle(e,t,n,r,i);return this.draw(a)}ellipse(e,t,n,r,i){let a=this.gen.ellipse(e,t,n,r,i);return this.draw(a)}circle(e,t,n,r){let i=this.gen.circle(e,t,n,r);return this.draw(i)}linearPath(e,t){let n=this.gen.linearPath(e,t);return this.draw(n)}polygon(e,t){let n=this.gen.polygon(e,t);return this.draw(n)}arc(e,t,n,r,i,a,o=!1,s){let c=this.gen.arc(e,t,n,r,i,a,o,s);return this.draw(c)}curve(e,t){let n=this.gen.curve(e,t);return this.draw(n)}path(e,t){let n=this.gen.path(e,t);return this.draw(n)}},V={canvas:(e,t)=>new ze(e,t),svg:(e,t)=>new Ve(e,t),generator:e=>new Re(e),newSeed:()=>Re.newSeed()},H=a(async(n,i,s)=>{let l,u=i.useHtmlLabels||m(f()?.htmlLabels);l=s||`node default`;let d=n.insert(`g`).attr(`class`,l).attr(`id`,i.domId||i.id),h=d.insert(`g`).attr(`class`,`label`).attr(`style`,r(i.labelStyle)),g;g=i.label===void 0?``:typeof i.label==`string`?i.label:i.label[0];let v=await _(h,c(e(g),f()),{useHtmlLabels:u,width:i.width||f().flowchart?.wrappingWidth,cssClasses:`markdown-node-label`,style:i.labelStyle,addSvgBackground:!!i.icon||!!i.img}),y=v.getBBox(),b=(i?.padding??0)/2;if(u){let e=v.children[0],n=o(v),r=e.getElementsByTagName(`img`);if(r){let e=g.replace(/<img[^>]*>/g,``).trim()===``;await Promise.all([...r].map(n=>new Promise(r=>{function i(){if(n.style.display=`flex`,n.style.flexDirection=`column`,e){let[e=p.fontSize]=t(f().fontSize?f().fontSize:window.getComputedStyle(document.body).fontSize),r=e*5+`px`;n.style.minWidth=r,n.style.maxWidth=r}else n.style.width=`100%`;r(n)}a(i,`setupImage`),setTimeout(()=>{n.complete&&i()}),n.addEventListener(`error`,i),n.addEventListener(`load`,i)})))}y=e.getBoundingClientRect(),n.attr(`width`,y.width),n.attr(`height`,y.height)}return u?h.attr(`transform`,`translate(`+-y.width/2+`, `+-y.height/2+`)`):h.attr(`transform`,`translate(0, `+-y.height/2+`)`),i.centerLabel&&h.attr(`transform`,`translate(`+-y.width/2+`, `+-y.height/2+`)`),h.insert(`rect`,`:first-child`),{shapeSvg:d,bbox:y,halfPadding:b,label:h}},`labelHelper`),He=a(async(t,n,r)=>{let i=r.useHtmlLabels||m(f()?.flowchart?.htmlLabels),a=t.insert(`g`).attr(`class`,`label`).attr(`style`,r.labelStyle||``),s=await _(a,c(e(n),f()),{useHtmlLabels:i,width:r.width||f()?.flowchart?.wrappingWidth,style:r.labelStyle,addSvgBackground:!!r.icon||!!r.img}),l=s.getBBox(),u=r.padding/2;if(m(f()?.flowchart?.htmlLabels)){let e=s.children[0],t=o(s);l=e.getBoundingClientRect(),t.attr(`width`,l.width),t.attr(`height`,l.height)}return i?a.attr(`transform`,`translate(`+-l.width/2+`, `+-l.height/2+`)`):a.attr(`transform`,`translate(0, `+-l.height/2+`)`),r.centerLabel&&a.attr(`transform`,`translate(`+-l.width/2+`, `+-l.height/2+`)`),a.insert(`rect`,`:first-child`),{shapeSvg:t,bbox:l,halfPadding:u,label:a}},`insertLabel`),U=a((e,t)=>{let n=t.node().getBBox();e.width=n.width,e.height=n.height},`updateNodeBounds`),W=a((e,t)=>(e.look===`handDrawn`?`rough-node`:`node`)+` `+e.cssClasses+` `+(t||``),`getNodeClasses`);function G(e){let t=e.map((e,t)=>`${t===0?`M`:`L`}${e.x},${e.y}`);return t.push(`Z`),t.join(` `)}a(G,`createPathFromPoints`);function K(e,t,n,r,i,a){let o=[],s=n-e,c=r-t,l=s/a,u=2*Math.PI/l,d=t+c/2;for(let t=0;t<=50;t++){let n=e+t/50*s,r=d+i*Math.sin(u*(n-e));o.push({x:n,y:r})}return o}a(K,`generateFullSineWavePoints`);function Ue(e,t,n,r,i,a){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:-a,y:-l})}return o}a(Ue,`generateCirclePoints`);var We=a((e,t)=>{var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2,c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=a===0?0:s*i/a,l=s):(i<0&&(o=-o),c=o,l=i===0?0:o*a/i),{x:n+c,y:r+l}},`intersectRect`);function Ge(e,t){t&&e.attr(`style`,t)}a(Ge,`applyStyle`);async function Ke(e){let t=o(document.createElementNS(`http://www.w3.org/2000/svg`,`foreignObject`)),n=t.append(`xhtml:div`),r=f(),i=e.label;e.label&&d(e.label)&&(i=await u(e.label.replace(h.lineBreakRegex,`
`),r));let a=`<span class="`+(e.isNode?`nodeLabel`:`edgeLabel`)+`" `+(e.labelStyle?`style="`+e.labelStyle+`"`:``)+`>`+i+`</span>`;return n.html(c(a,r)),Ge(n,e.labelStyle),n.style(`display`,`inline-block`),n.style(`padding-right`,`1px`),n.style(`white-space`,`nowrap`),n.attr(`xmlns`,`http://www.w3.org/1999/xhtml`),t.node()}a(Ke,`addHtmlLabel`);var qe=a(async(t,n,r,a)=>{let o=t||``;if(typeof o==`object`&&(o=o[0]),m(f().flowchart.htmlLabels))return o=o.replace(/\\n|\n/g,`<br />`),i.info(`vertexText`+o),await Ke({isNode:a,label:e(o).replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(`:`,` `)}'></i>`),labelStyle:n&&n.replace(`fill:`,`color:`)});{let e=document.createElementNS(`http://www.w3.org/2000/svg`,`text`);e.setAttribute(`style`,n.replace(`color:`,`fill:`));let t=[];t=typeof o==`string`?o.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(o)?o:[];for(let n of t){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);t.setAttributeNS(`http://www.w3.org/XML/1998/namespace`,`xml:space`,`preserve`),t.setAttribute(`dy`,`1em`),t.setAttribute(`x`,`0`),r?t.setAttribute(`class`,`title-row`):t.setAttribute(`class`,`row`),t.textContent=n.trim(),e.appendChild(t)}return e}},`createLabel`),q=a((e,t,n,r,i)=>[`M`,e+i,t,`H`,e+n-i,`A`,i,i,0,0,1,e+n,t+i,`V`,t+r-i,`A`,i,i,0,0,1,e+n-i,t+r,`H`,e+i,`A`,i,i,0,0,1,e,t+r-i,`V`,t+i,`A`,i,i,0,0,1,e+i,t,`Z`].join(` `),`createRoundedRectPathD`),Je=a(async(e,t)=>{i.info(`Creating subgraph rect for `,t.id,t);let n=f(),{themeVariables:r,handDrawnSeed:a}=n,{clusterBkg:s,clusterBorder:c}=r,{labelStyles:l,nodeStyles:u,borderStyles:d,backgroundStyles:p}=x(t),h=e.insert(`g`).attr(`class`,`cluster `+t.cssClasses).attr(`id`,t.id).attr(`data-look`,t.look),g=m(n.flowchart.htmlLabels),v=h.insert(`g`).attr(`class`,`cluster-label `),S=await _(v,t.label,{style:t.labelStyle,useHtmlLabels:g,isNode:!0}),C=S.getBBox();if(m(n.flowchart.htmlLabels)){let e=S.children[0],t=o(S);C=e.getBoundingClientRect(),t.attr(`width`,C.width),t.attr(`height`,C.height)}let w=t.width<=C.width+t.padding?C.width+t.padding:t.width;t.width<=C.width+t.padding?t.diff=(w-t.width)/2-t.padding:t.diff=-t.padding;let T=t.height,E=t.x-w/2,D=t.y-T/2;i.trace(`Data `,t,JSON.stringify(t));let O;if(t.look===`handDrawn`){let e=V.svg(h),n=b(t,{roughness:.7,fill:s,stroke:c,fillWeight:3,seed:a}),r=e.path(q(E,D,w,T,0),n);O=h.insert(()=>(i.debug(`Rough node insert CXC`,r),r),`:first-child`),O.select(`path:nth-child(2)`).attr(`style`,d.join(`;`)),O.select(`path`).attr(`style`,p.join(`;`).replace(`fill`,`stroke`))}else O=h.insert(`rect`,`:first-child`),O.attr(`style`,u).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,E).attr(`y`,D).attr(`width`,w).attr(`height`,T);let{subGraphTitleTopMargin:k}=y(n);if(v.attr(`transform`,`translate(${t.x-C.width/2}, ${t.y-t.height/2+k})`),l){let e=v.select(`span`);e&&e.attr(`style`,l)}let A=O.node().getBBox();return t.offsetX=0,t.width=A.width,t.height=A.height,t.offsetY=C.height-t.padding/2,t.intersect=function(e){return We(t,e)},{cluster:h,labelBBox:C}},`rect`),Ye={rect:Je,squareRect:Je,roundedWithTitle:a(async(e,t)=>{let n=f(),{themeVariables:r,handDrawnSeed:i}=n,{altBackground:a,compositeBackground:s,compositeTitleBackground:c,nodeBorder:l}=r,u=e.insert(`g`).attr(`class`,t.cssClasses).attr(`id`,t.id).attr(`data-id`,t.id).attr(`data-look`,t.look),d=u.insert(`g`,`:first-child`),p=u.insert(`g`).attr(`class`,`cluster-label`),h=u.append(`rect`),g=p.node().appendChild(await qe(t.label,t.labelStyle,void 0,!0)),_=g.getBBox();if(m(n.flowchart.htmlLabels)){let e=g.children[0],t=o(g);_=e.getBoundingClientRect(),t.attr(`width`,_.width),t.attr(`height`,_.height)}let v=0*t.padding,y=v/2,b=(t.width<=_.width+t.padding?_.width+t.padding:t.width)+v;t.width<=_.width+t.padding?t.diff=(b-t.width)/2-t.padding:t.diff=-t.padding;let x=t.height+v,S=t.height+v-_.height-6,C=t.x-b/2,w=t.y-x/2;t.width=b;let T=t.y-t.height/2-y+_.height+2,E;if(t.look===`handDrawn`){let e=t.cssClasses.includes(`statediagram-cluster-alt`),n=V.svg(u),r=t.rx||t.ry?n.path(q(C,w,b,x,10),{roughness:.7,fill:c,fillStyle:`solid`,stroke:l,seed:i}):n.rectangle(C,w,b,x,{seed:i});E=u.insert(()=>r,`:first-child`);let o=n.rectangle(C,T,b,S,{fill:e?a:s,fillStyle:e?`hachure`:`solid`,stroke:l,seed:i});E=u.insert(()=>r,`:first-child`),h=u.insert(()=>o)}else E=d.insert(`rect`,`:first-child`),E.attr(`class`,`outer`).attr(`x`,C).attr(`y`,w).attr(`width`,b).attr(`height`,x).attr(`data-look`,t.look),h.attr(`class`,`inner`).attr(`x`,C).attr(`y`,T).attr(`width`,b).attr(`height`,S);return p.attr(`transform`,`translate(${t.x-_.width/2}, ${w+1-(m(n.flowchart.htmlLabels)?0:3)})`),t.height=E.node().getBBox().height,t.offsetX=0,t.offsetY=_.height-t.padding/2,t.labelBBox=_,t.intersect=function(e){return We(t,e)},{cluster:u,labelBBox:_}},`roundedWithTitle`),noteGroup:a((e,t)=>{let n=e.insert(`g`).attr(`class`,`note-cluster`).attr(`id`,t.id),r=n.insert(`rect`,`:first-child`),i=0*t.padding,a=i/2;r.attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,t.x-t.width/2-a).attr(`y`,t.y-t.height/2-a).attr(`width`,t.width+i).attr(`height`,t.height+i).attr(`fill`,`none`);let o=r.node().getBBox();return t.width=o.width,t.height=o.height,t.intersect=function(e){return We(t,e)},{cluster:n,labelBBox:{width:0,height:0}}},`noteGroup`),divider:a((e,t)=>{let{themeVariables:n,handDrawnSeed:r}=f(),{nodeBorder:i}=n,a=e.insert(`g`).attr(`class`,t.cssClasses).attr(`id`,t.id).attr(`data-look`,t.look),o=a.insert(`g`,`:first-child`),s=0*t.padding,c=t.width+s;t.diff=-t.padding;let l=t.height+s,u=t.x-c/2,d=t.y-l/2;t.width=c;let p;if(t.look===`handDrawn`){let e=V.svg(a).rectangle(u,d,c,l,{fill:`lightgrey`,roughness:.5,strokeLineDash:[5],stroke:i,seed:r});p=a.insert(()=>e,`:first-child`)}else p=o.insert(`rect`,`:first-child`),p.attr(`class`,`divider`).attr(`x`,u).attr(`y`,d).attr(`width`,c).attr(`height`,l).attr(`data-look`,t.look);return t.height=p.node().getBBox().height,t.offsetX=0,t.offsetY=0,t.intersect=function(e){return We(t,e)},{cluster:a,labelBBox:{}}},`divider`),kanbanSection:a(async(e,t)=>{i.info(`Creating subgraph rect for `,t.id,t);let n=f(),{themeVariables:r,handDrawnSeed:a}=n,{clusterBkg:s,clusterBorder:c}=r,{labelStyles:l,nodeStyles:u,borderStyles:d,backgroundStyles:p}=x(t),h=e.insert(`g`).attr(`class`,`cluster `+t.cssClasses).attr(`id`,t.id).attr(`data-look`,t.look),g=m(n.flowchart.htmlLabels),v=h.insert(`g`).attr(`class`,`cluster-label `),S=await _(v,t.label,{style:t.labelStyle,useHtmlLabels:g,isNode:!0,width:t.width}),C=S.getBBox();if(m(n.flowchart.htmlLabels)){let e=S.children[0],t=o(S);C=e.getBoundingClientRect(),t.attr(`width`,C.width),t.attr(`height`,C.height)}let w=t.width<=C.width+t.padding?C.width+t.padding:t.width;t.width<=C.width+t.padding?t.diff=(w-t.width)/2-t.padding:t.diff=-t.padding;let T=t.height,E=t.x-w/2,D=t.y-T/2;i.trace(`Data `,t,JSON.stringify(t));let O;if(t.look===`handDrawn`){let e=V.svg(h),n=b(t,{roughness:.7,fill:s,stroke:c,fillWeight:4,seed:a}),r=e.path(q(E,D,w,T,t.rx),n);O=h.insert(()=>(i.debug(`Rough node insert CXC`,r),r),`:first-child`),O.select(`path:nth-child(2)`).attr(`style`,d.join(`;`)),O.select(`path`).attr(`style`,p.join(`;`).replace(`fill`,`stroke`))}else O=h.insert(`rect`,`:first-child`),O.attr(`style`,u).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,E).attr(`y`,D).attr(`width`,w).attr(`height`,T);let{subGraphTitleTopMargin:k}=y(n);if(v.attr(`transform`,`translate(${t.x-C.width/2}, ${t.y-t.height/2+k})`),l){let e=v.select(`span`);e&&e.attr(`style`,l)}let A=O.node().getBBox();return t.offsetX=0,t.width=A.width,t.height=A.height,t.offsetY=C.height-t.padding/2,t.intersect=function(e){return We(t,e)},{cluster:h,labelBBox:C}},`kanbanSection`)},Xe=new Map,Ze=a(async(e,t)=>{let n=await Ye[t.shape||`rect`](e,t);return Xe.set(t.id,n),n},`insertCluster`),Qe=a(()=>{Xe=new Map},`clear`);function $e(e,t){return e.intersect(t)}a($e,`intersectNode`);var et=$e;function tt(e,t,n,r){var i=e.x,a=e.y,o=i-r.x,s=a-r.y,c=Math.sqrt(t*t*s*s+n*n*o*o),l=Math.abs(t*n*o/c);r.x<i&&(l=-l);var u=Math.abs(t*n*s/c);return r.y<a&&(u=-u),{x:i+l,y:a+u}}a(tt,`intersectEllipse`);var nt=tt;function rt(e,t,n){return nt(e,t,t,n)}a(rt,`intersectCircle`);var it=rt;function at(e,t,n,r){{let i=t.y-e.y,a=e.x-t.x,o=t.x*e.y-e.x*t.y,s=i*n.x+a*n.y+o,c=i*r.x+a*r.y+o,l=1e-6;if(s!==0&&c!==0&&ot(s,c))return;let u=r.y-n.y,d=n.x-r.x,f=r.x*n.y-n.x*r.y,p=u*e.x+d*e.y+f,m=u*t.x+d*t.y+f;if(Math.abs(p)<l&&Math.abs(m)<l&&ot(p,m))return;let h=i*d-u*a;if(h===0)return;let g=Math.abs(h/2),_=a*f-d*o,v=_<0?(_-g)/h:(_+g)/h;return _=u*o-i*f,{x:v,y:_<0?(_-g)/h:(_+g)/h}}}a(at,`intersectLine`);function ot(e,t){return e*t>0}a(ot,`sameSign`);var st=at;function ct(e,t,n){let r=e.x,i=e.y,a=[],o=1/0,s=1/0;typeof t.forEach==`function`?t.forEach(function(e){o=Math.min(o,e.x),s=Math.min(s,e.y)}):(o=Math.min(o,t.x),s=Math.min(s,t.y));let c=r-e.width/2-o,l=i-e.height/2-s;for(let r=0;r<t.length;r++){let i=t[r],o=t[r<t.length-1?r+1:0],s=st(e,n,{x:c+i.x,y:l+i.y},{x:c+o.x,y:l+o.y});s&&a.push(s)}return a.length?(a.length>1&&a.sort(function(e,t){let r=e.x-n.x,i=e.y-n.y,a=Math.sqrt(r*r+i*i),o=t.x-n.x,s=t.y-n.y,c=Math.sqrt(o*o+s*s);return a<c?-1:a===c?0:1}),a[0]):e}a(ct,`intersectPolygon`);var J={node:et,circle:it,ellipse:nt,polygon:ct,rect:We};function lt(e,t){let{labelStyles:n}=x(t);t.labelStyle=n;let a=W(t),o=a;a||(o=`anchor`);let s=e.insert(`g`).attr(`class`,o).attr(`id`,t.domId||t.id),{cssStyles:c}=t,l=V.svg(s),u=b(t,{fill:`black`,stroke:`none`,fillStyle:`solid`});t.look!==`handDrawn`&&(u.roughness=0);let d=l.circle(0,0,2,u),f=s.insert(()=>d,`:first-child`);return f.attr(`class`,`anchor`).attr(`style`,r(c)),U(t,f),t.intersect=function(e){return i.info(`Circle intersect`,t,1,e),J.circle(t,1,e)},s}a(lt,`anchor`);function ut(e,t,n,r,i,a,o){let s=(e+n)/2,c=(t+r)/2,l=Math.atan2(r-t,n-e),u=(n-e)/2,d=(r-t)/2,f=u/i,p=d/a,m=Math.sqrt(f**2+p**2);if(m>1)throw Error(`The given radii are too small to create an arc between the points.`);let h=Math.sqrt(1-m**2),g=s+h*a*Math.sin(l)*(o?-1:1),_=c-h*i*Math.cos(l)*(o?-1:1),v=Math.atan2((t-_)/a,(e-g)/i),y=Math.atan2((r-_)/a,(n-g)/i)-v;o&&y<0&&(y+=2*Math.PI),!o&&y>0&&(y-=2*Math.PI);let b=[];for(let e=0;e<20;e++){let t=v+e/19*y,n=g+i*Math.cos(t),r=_+a*Math.sin(t);b.push({x:n,y:r})}return b}a(ut,`generateArcPoints`);async function dt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=a.width+t.padding+20,s=a.height+t.padding,c=s/2,l=c/(2.5+s/50),{cssStyles:u}=t,d=[{x:o/2,y:-s/2},{x:-o/2,y:-s/2},...ut(-o/2,-s/2,-o/2,s/2,l,c,!1),{x:o/2,y:s/2},...ut(o/2,s/2,o/2,-s/2,l,c,!0)],f=V.svg(i),p=b(t,{});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=G(d),h=f.path(m,p),g=i.insert(()=>h,`:first-child`);return g.attr(`class`,`basic label-container`),u&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,r),g.attr(`transform`,`translate(${l/2}, 0)`),U(t,g),t.intersect=function(e){return J.polygon(t,d,e)},i}a(dt,`bowTieRect`);function Y(e,t,n,r){return e.insert(`polygon`,`:first-child`).attr(`points`,r.map(function(e){return e.x+`,`+e.y}).join(` `)).attr(`class`,`label-container`).attr(`transform`,`translate(`+-t/2+`,`+n/2+`)`)}a(Y,`insertPolygonShape`);async function ft(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=a.height+t.padding,s=a.width+t.padding+12,c=s,l=-o,u=[{x:12,y:l},{x:c,y:l},{x:c,y:0},{x:0,y:0},{x:0,y:l+12},{x:12,y:l}],d,{cssStyles:f}=t;if(t.look===`handDrawn`){let e=V.svg(i),n=b(t,{}),r=G(u),a=e.path(r,n);d=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-s/2}, ${o/2})`),f&&d.attr(`style`,f)}else d=Y(i,s,o,u);return r&&d.attr(`style`,r),U(t,d),t.intersect=function(e){return J.polygon(t,u,e)},i}a(ft,`card`);function pt(e,t){let{nodeStyles:n}=x(t);t.label=``;let r=e.insert(`g`).attr(`class`,W(t)).attr(`id`,t.domId??t.id),{cssStyles:i}=t,a=Math.max(28,t.width??0),o=[{x:0,y:a/2},{x:a/2,y:0},{x:0,y:-a/2},{x:-a/2,y:0}],s=V.svg(r),c=b(t,{});t.look!==`handDrawn`&&(c.roughness=0,c.fillStyle=`solid`);let l=G(o),u=s.path(l,c),d=r.insert(()=>u,`:first-child`);return i&&t.look!==`handDrawn`&&d.selectAll(`path`).attr(`style`,i),n&&t.look!==`handDrawn`&&d.selectAll(`path`).attr(`style`,n),t.width=28,t.height=28,t.intersect=function(e){return J.polygon(t,o,e)},r}a(pt,`choice`);async function mt(e,t,n){let{labelStyles:a,nodeStyles:o}=x(t);t.labelStyle=a;let{shapeSvg:s,bbox:c,halfPadding:l}=await H(e,t,W(t)),u=n?.padding??l,d=c.width/2+u,f,{cssStyles:p}=t;if(t.look===`handDrawn`){let e=V.svg(s),n=b(t,{}),i=e.circle(0,0,d*2,n);f=s.insert(()=>i,`:first-child`),f.attr(`class`,`basic label-container`).attr(`style`,r(p))}else f=s.insert(`circle`,`:first-child`).attr(`class`,`basic label-container`).attr(`style`,o).attr(`r`,d).attr(`cx`,0).attr(`cy`,0);return U(t,f),t.calcIntersect=function(e,t){let n=e.width/2;return J.circle(e,n,t)},t.intersect=function(e){return i.info(`Circle intersect`,t,d,e),J.circle(t,d,e)},s}a(mt,`circle`);function ht(e){let t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,i={x:r/2*t,y:r/2*n},a={x:-(r/2)*t,y:r/2*n},o={x:-(r/2)*t,y:-(r/2)*n},s={x:r/2*t,y:-(r/2)*n};return`M ${a.x},${a.y} L ${s.x},${s.y}
                   M ${i.x},${i.y} L ${o.x},${o.y}`}a(ht,`createLine`);function gt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n,t.label=``;let a=e.insert(`g`).attr(`class`,W(t)).attr(`id`,t.domId??t.id),o=Math.max(30,t?.width??0),{cssStyles:s}=t,c=V.svg(a),l=b(t,{});t.look!==`handDrawn`&&(l.roughness=0,l.fillStyle=`solid`);let u=c.circle(0,0,o*2,l),d=ht(o),f=c.path(d,l),p=a.insert(()=>u,`:first-child`);return p.insert(()=>f),s&&t.look!==`handDrawn`&&p.selectAll(`path`).attr(`style`,s),r&&t.look!==`handDrawn`&&p.selectAll(`path`).attr(`style`,r),U(t,p),t.intersect=function(e){return i.info(`crossedCircle intersect`,t,{radius:o,point:e}),J.circle(t,o,e)},a}a(gt,`crossedCircle`);function X(e,t,n,r=100,i=0,a=180){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:-a,y:-l})}return o}a(X,`generateCirclePoints`);async function _t(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=a.width+(t.padding??0),c=a.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:u}=t,d=[...X(s/2,-c/2,l,30,-90,0),{x:-s/2-l,y:l},...X(s/2+l*2,-l,l,20,-180,-270),...X(s/2+l*2,l,l,20,-90,-180),{x:-s/2-l,y:-c/2},...X(s/2,c/2,l,20,0,90)],f=[{x:s/2,y:-c/2-l},{x:-s/2,y:-c/2-l},...X(s/2,-c/2,l,20,-90,0),{x:-s/2-l,y:-l},...X(s/2+s*.1,-l,l,20,-180,-270),...X(s/2+s*.1,l,l,20,-90,-180),{x:-s/2-l,y:c/2},...X(s/2,c/2,l,20,0,90),{x:-s/2,y:c/2+l},{x:s/2,y:c/2+l}],p=V.svg(i),m=b(t,{fill:`none`});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=G(d).replace(`Z`,``),g=p.path(h,m),_=G(f),v=p.path(_,{...m}),y=i.insert(`g`,`:first-child`);return y.insert(()=>v,`:first-child`).attr(`stroke-opacity`,0),y.insert(()=>g,`:first-child`),y.attr(`class`,`text`),u&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),y.attr(`transform`,`translate(${l}, 0)`),o.attr(`transform`,`translate(${-s/2+l-(a.x-(a.left??0))},${-c/2+(t.padding??0)/2-(a.y-(a.top??0))})`),U(t,y),t.intersect=function(e){return J.polygon(t,f,e)},i}a(_t,`curlyBraceLeft`);function Z(e,t,n,r=100,i=0,a=180){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:a,y:l})}return o}a(Z,`generateCirclePoints`);async function vt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=a.width+(t.padding??0),c=a.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:u}=t,d=[...Z(s/2,-c/2,l,20,-90,0),{x:s/2+l,y:-l},...Z(s/2+l*2,-l,l,20,-180,-270),...Z(s/2+l*2,l,l,20,-90,-180),{x:s/2+l,y:c/2},...Z(s/2,c/2,l,20,0,90)],f=[{x:-s/2,y:-c/2-l},{x:s/2,y:-c/2-l},...Z(s/2,-c/2,l,20,-90,0),{x:s/2+l,y:-l},...Z(s/2+l*2,-l,l,20,-180,-270),...Z(s/2+l*2,l,l,20,-90,-180),{x:s/2+l,y:c/2},...Z(s/2,c/2,l,20,0,90),{x:s/2,y:c/2+l},{x:-s/2,y:c/2+l}],p=V.svg(i),m=b(t,{fill:`none`});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=G(d).replace(`Z`,``),g=p.path(h,m),_=G(f),v=p.path(_,{...m}),y=i.insert(`g`,`:first-child`);return y.insert(()=>v,`:first-child`).attr(`stroke-opacity`,0),y.insert(()=>g,`:first-child`),y.attr(`class`,`text`),u&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),y.attr(`transform`,`translate(${-l}, 0)`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)/2-(a.x-(a.left??0))},${-c/2+(t.padding??0)/2-(a.y-(a.top??0))})`),U(t,y),t.intersect=function(e){return J.polygon(t,f,e)},i}a(vt,`curlyBraceRight`);function Q(e,t,n,r=100,i=0,a=180){let o=[],s=i*Math.PI/180,c=(a*Math.PI/180-s)/(r-1);for(let i=0;i<r;i++){let r=s+i*c,a=e+n*Math.cos(r),l=t+n*Math.sin(r);o.push({x:-a,y:-l})}return o}a(Q,`generateCirclePoints`);async function yt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=a.width+(t.padding??0),c=a.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:u}=t,d=[...Q(s/2,-c/2,l,30,-90,0),{x:-s/2-l,y:l},...Q(s/2+l*2,-l,l,20,-180,-270),...Q(s/2+l*2,l,l,20,-90,-180),{x:-s/2-l,y:-c/2},...Q(s/2,c/2,l,20,0,90)],f=[...Q(-s/2+l+l/2,-c/2,l,20,-90,-180),{x:s/2-l/2,y:l},...Q(-s/2-l/2,-l,l,20,0,90),...Q(-s/2-l/2,l,l,20,-90,0),{x:s/2-l/2,y:-l},...Q(-s/2+l+l/2,c/2,l,30,-180,-270)],p=[{x:s/2,y:-c/2-l},{x:-s/2,y:-c/2-l},...Q(s/2,-c/2,l,20,-90,0),{x:-s/2-l,y:-l},...Q(s/2+l*2,-l,l,20,-180,-270),...Q(s/2+l*2,l,l,20,-90,-180),{x:-s/2-l,y:c/2},...Q(s/2,c/2,l,20,0,90),{x:-s/2,y:c/2+l},{x:s/2-l-l/2,y:c/2+l},...Q(-s/2+l+l/2,-c/2,l,20,-90,-180),{x:s/2-l/2,y:l},...Q(-s/2-l/2,-l,l,20,0,90),...Q(-s/2-l/2,l,l,20,-90,0),{x:s/2-l/2,y:-l},...Q(-s/2+l+l/2,c/2,l,30,-180,-270)],m=V.svg(i),h=b(t,{fill:`none`});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=G(d).replace(`Z`,``),_=m.path(g,h),v=G(f).replace(`Z`,``),y=m.path(v,h),S=G(p),C=m.path(S,{...h}),w=i.insert(`g`,`:first-child`);return w.insert(()=>C,`:first-child`).attr(`stroke-opacity`,0),w.insert(()=>_,`:first-child`),w.insert(()=>y,`:first-child`),w.attr(`class`,`text`),u&&t.look!==`handDrawn`&&w.selectAll(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&w.selectAll(`path`).attr(`style`,r),w.attr(`transform`,`translate(${l-l/4}, 0)`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)/2-(a.x-(a.left??0))},${-c/2+(t.padding??0)/2-(a.y-(a.top??0))})`),U(t,w),t.intersect=function(e){return J.polygon(t,p,e)},i}a(yt,`curlyBraces`);async function bt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(80,(a.width+(t.padding??0)*2)*1.25,t?.width??0),s=Math.max(20,a.height+(t.padding??0)*2,t?.height??0),c=s/2,{cssStyles:l}=t,u=V.svg(i),d=b(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=o,p=s,m=f-c,h=p/4,g=[{x:m,y:0},{x:h,y:0},{x:0,y:p/2},{x:h,y:p},{x:m,y:p},...Ue(-m,-p/2,c,50,270,90)],_=G(g),v=u.path(_,d),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),l&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,l),r&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,r),y.attr(`transform`,`translate(${-o/2}, ${-s/2})`),U(t,y),t.intersect=function(e){return J.polygon(t,g,e)},i}a(bt,`curvedTrapezoid`);var xt=a((e,t,n,r,i,a)=>[`M${e},${t+a}`,`a${i},${a} 0,0,0 ${n},0`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`].join(` `),`createCylinderPathD`),St=a((e,t,n,r,i,a)=>[`M${e},${t+a}`,`M${e+n},${t+a}`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`].join(` `),`createOuterCylinderPathD`),Ct=a((e,t,n,r,i,a)=>[`M${e-n/2},${-r/2}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createInnerCylinderPathD`);async function wt(e,t){let{labelStyles:n,nodeStyles:i}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o,label:s}=await H(e,t,W(t)),c=Math.max(o.width+t.padding,t.width??0),l=c/2,u=l/(2.5+c/50),d=Math.max(o.height+u+t.padding,t.height??0),f,{cssStyles:p}=t;if(t.look===`handDrawn`){let e=V.svg(a),n=St(0,0,c,d,l,u),r=Ct(0,u,c,d,l,u),i=e.path(n,b(t,{})),o=e.path(r,b(t,{fill:`none`}));f=a.insert(()=>o,`:first-child`),f=a.insert(()=>i,`:first-child`),f.attr(`class`,`basic label-container`),p&&f.attr(`style`,p)}else{let e=xt(0,0,c,d,l,u);f=a.insert(`path`,`:first-child`).attr(`d`,e).attr(`class`,`basic label-container`).attr(`style`,r(p)).attr(`style`,i)}return f.attr(`label-offset-y`,u),f.attr(`transform`,`translate(${-c/2}, ${-(d/2+u)})`),U(t,f),s.attr(`transform`,`translate(${-(o.width/2)-(o.x-(o.left??0))}, ${-(o.height/2)+(t.padding??0)/1.5-(o.y-(o.top??0))})`),t.intersect=function(e){let n=J.rect(t,e),r=n.x-(t.x??0);if(l!=0&&(Math.abs(r)<(t.width??0)/2||Math.abs(r)==(t.width??0)/2&&Math.abs(n.y-(t.y??0))>(t.height??0)/2-u)){let i=u*u*(1-r*r/(l*l));i>0&&(i=Math.sqrt(i)),i=u-i,e.y-(t.y??0)>0&&(i=-i),n.y+=i}return n},a}a(wt,`cylinder`);async function Tt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=a.width+t.padding,c=a.height+t.padding,l=c*.2,u=-s/2,d=-c/2-l/2,{cssStyles:f}=t,p=V.svg(i),m=b(t,{});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=[{x:u,y:d+l},{x:-u,y:d+l},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+l}],g=p.polygon(h.map(e=>[e.x,e.y]),m),_=i.insert(()=>g,`:first-child`);return _.attr(`class`,`basic label-container`),f&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,f),r&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,r),o.attr(`transform`,`translate(${u+(t.padding??0)/2-(a.x-(a.left??0))}, ${d+l+(t.padding??0)/2-(a.y-(a.top??0))})`),U(t,_),t.intersect=function(e){return J.rect(t,e)},i}a(Tt,`dividedRectangle`);async function Et(e,t){let{labelStyles:n,nodeStyles:a}=x(t);t.labelStyle=n;let{shapeSvg:o,bbox:s,halfPadding:c}=await H(e,t,W(t)),l=s.width/2+c+5,u=s.width/2+c,d,{cssStyles:f}=t;if(t.look===`handDrawn`){let e=V.svg(o),n=b(t,{roughness:.2,strokeWidth:2.5}),i=b(t,{roughness:.2,strokeWidth:1.5}),a=e.circle(0,0,l*2,n),s=e.circle(0,0,u*2,i);d=o.insert(`g`,`:first-child`),d.attr(`class`,r(t.cssClasses)).attr(`style`,r(f)),d.node()?.appendChild(a),d.node()?.appendChild(s)}else{d=o.insert(`g`,`:first-child`);let e=d.insert(`circle`,`:first-child`),t=d.insert(`circle`);d.attr(`class`,`basic label-container`).attr(`style`,a),e.attr(`class`,`outer-circle`).attr(`style`,a).attr(`r`,l).attr(`cx`,0).attr(`cy`,0),t.attr(`class`,`inner-circle`).attr(`style`,a).attr(`r`,u).attr(`cx`,0).attr(`cy`,0)}return U(t,d),t.intersect=function(e){return i.info(`DoubleCircle intersect`,t,l,e),J.circle(t,l,e)},o}a(Et,`doublecircle`);function Dt(e,t,{config:{themeVariables:n}}){let{labelStyles:r,nodeStyles:a}=x(t);t.label=``,t.labelStyle=r;let o=e.insert(`g`).attr(`class`,W(t)).attr(`id`,t.domId??t.id),{cssStyles:s}=t,c=V.svg(o),{nodeBorder:l}=n,u=b(t,{fillStyle:`solid`});t.look!==`handDrawn`&&(u.roughness=0);let d=c.circle(0,0,14,u),f=o.insert(()=>d,`:first-child`);return f.selectAll(`path`).attr(`style`,`fill: ${l} !important;`),s&&s.length>0&&t.look!==`handDrawn`&&f.selectAll(`path`).attr(`style`,s),a&&t.look!==`handDrawn`&&f.selectAll(`path`).attr(`style`,a),U(t,f),t.intersect=function(e){return i.info(`filledCircle intersect`,t,{radius:7,point:e}),J.circle(t,7,e)},o}a(Dt,`filledCircle`);async function Ot(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o,label:s}=await H(e,t,W(t)),c=o.width+(t.padding??0),l=c+o.height,u=c+o.height,d=[{x:0,y:-l},{x:u,y:-l},{x:u/2,y:0}],{cssStyles:f}=t,p=V.svg(a),m=b(t,{});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=G(d),g=p.path(h,m),_=a.insert(()=>g,`:first-child`).attr(`transform`,`translate(${-l/2}, ${l/2})`);return f&&t.look!==`handDrawn`&&_.selectChildren(`path`).attr(`style`,f),r&&t.look!==`handDrawn`&&_.selectChildren(`path`).attr(`style`,r),t.width=c,t.height=l,U(t,_),s.attr(`transform`,`translate(${-o.width/2-(o.x-(o.left??0))}, ${-l/2+(t.padding??0)/2+(o.y-(o.top??0))})`),t.intersect=function(e){return i.info(`Triangle intersect`,t,d,e),J.polygon(t,d,e)},a}a(Ot,`flippedTriangle`);function kt(e,t,{dir:n,config:{state:r,themeVariables:i}}){let{nodeStyles:a}=x(t);t.label=``;let o=e.insert(`g`).attr(`class`,W(t)).attr(`id`,t.domId??t.id),{cssStyles:s}=t,c=Math.max(70,t?.width??0),l=Math.max(10,t?.height??0);n===`LR`&&(c=Math.max(10,t?.width??0),l=Math.max(70,t?.height??0));let u=-1*c/2,d=-1*l/2,f=V.svg(o),p=b(t,{stroke:i.lineColor,fill:i.lineColor});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=f.rectangle(u,d,c,l,p),h=o.insert(()=>m,`:first-child`);s&&t.look!==`handDrawn`&&h.selectAll(`path`).attr(`style`,s),a&&t.look!==`handDrawn`&&h.selectAll(`path`).attr(`style`,a),U(t,h);let g=r?.padding??0;return t.width&&t.height&&(t.width+=g/2||0,t.height+=g/2||0),t.intersect=function(e){return J.rect(t,e)},o}a(kt,`forkJoin`);async function At(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o}=await H(e,t,W(t)),s=Math.max(80,o.width+(t.padding??0)*2,t?.width??0),c=Math.max(50,o.height+(t.padding??0)*2,t?.height??0),l=c/2,{cssStyles:u}=t,d=V.svg(a),f=b(t,{});t.look!==`handDrawn`&&(f.roughness=0,f.fillStyle=`solid`);let p=[{x:-s/2,y:-c/2},{x:s/2-l,y:-c/2},...Ue(-s/2+l,0,l,50,90,270),{x:s/2-l,y:c/2},{x:-s/2,y:c/2}],m=G(p),h=d.path(m,f),g=a.insert(()=>h,`:first-child`);return g.attr(`class`,`basic label-container`),u&&t.look!==`handDrawn`&&g.selectChildren(`path`).attr(`style`,u),r&&t.look!==`handDrawn`&&g.selectChildren(`path`).attr(`style`,r),U(t,g),t.intersect=function(e){return i.info(`Pill intersect`,t,{radius:l,point:e}),J.polygon(t,p,e)},a}a(At,`halfRoundedRectangle`);async function jt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=a.height+(t.padding??0),s=a.width+(t.padding??0)*2.5,{cssStyles:c}=t,l=V.svg(i),u=b(t,{});t.look!==`handDrawn`&&(u.roughness=0,u.fillStyle=`solid`);let d=s/2,f=d/6;d+=f;let p=o/2,m=p/2,h=d-m,g=[{x:-h,y:-p},{x:0,y:-p},{x:h,y:-p},{x:d,y:0},{x:h,y:p},{x:0,y:p},{x:-h,y:p},{x:-d,y:0}],_=G(g),v=l.path(_,u),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),c&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,c),r&&t.look!==`handDrawn`&&y.selectChildren(`path`).attr(`style`,r),t.width=s,t.height=o,U(t,y),t.intersect=function(e){return J.polygon(t,g,e)},i}a(jt,`hexagon`);async function Mt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.label=``,t.labelStyle=n;let{shapeSvg:a}=await H(e,t,W(t)),o=Math.max(30,t?.width??0),s=Math.max(30,t?.height??0),{cssStyles:c}=t,l=V.svg(a),u=b(t,{});t.look!==`handDrawn`&&(u.roughness=0,u.fillStyle=`solid`);let d=[{x:0,y:0},{x:o,y:0},{x:0,y:s},{x:o,y:s}],f=G(d),p=l.path(f,u),m=a.insert(()=>p,`:first-child`);return m.attr(`class`,`basic label-container`),c&&t.look!==`handDrawn`&&m.selectChildren(`path`).attr(`style`,c),r&&t.look!==`handDrawn`&&m.selectChildren(`path`).attr(`style`,r),m.attr(`transform`,`translate(${-o/2}, ${-s/2})`),U(t,m),t.intersect=function(e){return i.info(`Pill intersect`,t,{points:d}),J.polygon(t,d,e)},a}a(Mt,`hourglass`);async function Nt(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:a}=x(t);t.labelStyle=a;let o=t.assetHeight??48,s=t.assetWidth??48,c=Math.max(o,s),l=r?.wrappingWidth;t.width=Math.max(c,l??0);let{shapeSvg:u,bbox:d,label:f}=await H(e,t,`icon-shape default`),p=t.pos===`t`,m=c,h=c,{nodeBorder:g}=n,{stylesMap:_}=C(t),y=-h/2,S=-m/2,w=t.label?8:0,T=V.svg(u),E=b(t,{stroke:`none`,fill:`none`});t.look!==`handDrawn`&&(E.roughness=0,E.fillStyle=`solid`);let D=T.rectangle(y,S,h,m,E),O=Math.max(h,d.width),k=m+d.height+w,A=T.rectangle(-O/2,-k/2,O,k,{...E,fill:`transparent`,stroke:`none`}),j=u.insert(()=>D,`:first-child`),M=u.insert(()=>A);if(t.icon){let e=u.append(`g`);e.html(`<g>${await v(t.icon,{height:c,width:c,fallbackPrefix:``})}</g>`);let n=e.node().getBBox(),r=n.width,i=n.height,a=n.x,o=n.y;e.attr(`transform`,`translate(${-r/2-a},${p?d.height/2+w/2-i/2-o:-d.height/2-w/2-i/2-o})`),e.attr(`style`,`color: ${_.get(`stroke`)??g};`)}return f.attr(`transform`,`translate(${-d.width/2-(d.x-(d.left??0))},${p?-k/2:k/2-d.height})`),j.attr(`transform`,`translate(0,${p?d.height/2+w/2:-d.height/2-w/2})`),U(t,M),t.intersect=function(e){if(i.info(`iconSquare intersect`,t,e),!t.label)return J.rect(t,e);let n=t.x??0,r=t.y??0,a=t.height??0,o=[];return o=p?[{x:n-d.width/2,y:r-a/2},{x:n+d.width/2,y:r-a/2},{x:n+d.width/2,y:r-a/2+d.height+w},{x:n+h/2,y:r-a/2+d.height+w},{x:n+h/2,y:r+a/2},{x:n-h/2,y:r+a/2},{x:n-h/2,y:r-a/2+d.height+w},{x:n-d.width/2,y:r-a/2+d.height+w}]:[{x:n-h/2,y:r-a/2},{x:n+h/2,y:r-a/2},{x:n+h/2,y:r-a/2+m},{x:n+d.width/2,y:r-a/2+m},{x:n+d.width/2/2,y:r+a/2},{x:n-d.width/2,y:r+a/2},{x:n-d.width/2,y:r-a/2+m},{x:n-h/2,y:r-a/2+m}],J.polygon(t,o,e)},u}a(Nt,`icon`);async function Pt(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:a}=x(t);t.labelStyle=a;let o=t.assetHeight??48,s=t.assetWidth??48,c=Math.max(o,s),l=r?.wrappingWidth;t.width=Math.max(c,l??0);let{shapeSvg:u,bbox:d,label:f}=await H(e,t,`icon-shape default`),p=t.label?8:0,m=t.pos===`t`,{nodeBorder:h,mainBkg:g}=n,{stylesMap:_}=C(t),y=V.svg(u),S=b(t,{});t.look!==`handDrawn`&&(S.roughness=0,S.fillStyle=`solid`),S.stroke=_.get(`fill`)??g;let w=u.append(`g`);t.icon&&w.html(`<g>${await v(t.icon,{height:c,width:c,fallbackPrefix:``})}</g>`);let T=w.node().getBBox(),E=T.width,D=T.height,O=T.x,k=T.y,A=Math.max(E,D)*Math.SQRT2+40,j=y.circle(0,0,A,S),M=Math.max(A,d.width),N=A+d.height+p,P=y.rectangle(-M/2,-N/2,M,N,{...S,fill:`transparent`,stroke:`none`}),F=u.insert(()=>j,`:first-child`),I=u.insert(()=>P);return w.attr(`transform`,`translate(${-E/2-O},${m?d.height/2+p/2-D/2-k:-d.height/2-p/2-D/2-k})`),w.attr(`style`,`color: ${_.get(`stroke`)??h};`),f.attr(`transform`,`translate(${-d.width/2-(d.x-(d.left??0))},${m?-N/2:N/2-d.height})`),F.attr(`transform`,`translate(0,${m?d.height/2+p/2:-d.height/2-p/2})`),U(t,I),t.intersect=function(e){return i.info(`iconSquare intersect`,t,e),J.rect(t,e)},u}a(Pt,`iconCircle`);async function Ft(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:a}=x(t);t.labelStyle=a;let o=t.assetHeight??48,s=t.assetWidth??48,c=Math.max(o,s),l=r?.wrappingWidth;t.width=Math.max(c,l??0);let{shapeSvg:u,bbox:d,halfPadding:f,label:p}=await H(e,t,`icon-shape default`),m=t.pos===`t`,h=c+f*2,g=c+f*2,{nodeBorder:_,mainBkg:y}=n,{stylesMap:S}=C(t),w=-g/2,T=-h/2,E=t.label?8:0,D=V.svg(u),O=b(t,{});t.look!==`handDrawn`&&(O.roughness=0,O.fillStyle=`solid`),O.stroke=S.get(`fill`)??y;let k=D.path(q(w,T,g,h,5),O),A=Math.max(g,d.width),j=h+d.height+E,M=D.rectangle(-A/2,-j/2,A,j,{...O,fill:`transparent`,stroke:`none`}),N=u.insert(()=>k,`:first-child`).attr(`class`,`icon-shape2`),P=u.insert(()=>M);if(t.icon){let e=u.append(`g`);e.html(`<g>${await v(t.icon,{height:c,width:c,fallbackPrefix:``})}</g>`);let n=e.node().getBBox(),r=n.width,i=n.height,a=n.x,o=n.y;e.attr(`transform`,`translate(${-r/2-a},${m?d.height/2+E/2-i/2-o:-d.height/2-E/2-i/2-o})`),e.attr(`style`,`color: ${S.get(`stroke`)??_};`)}return p.attr(`transform`,`translate(${-d.width/2-(d.x-(d.left??0))},${m?-j/2:j/2-d.height})`),N.attr(`transform`,`translate(0,${m?d.height/2+E/2:-d.height/2-E/2})`),U(t,P),t.intersect=function(e){if(i.info(`iconSquare intersect`,t,e),!t.label)return J.rect(t,e);let n=t.x??0,r=t.y??0,a=t.height??0,o=[];return o=m?[{x:n-d.width/2,y:r-a/2},{x:n+d.width/2,y:r-a/2},{x:n+d.width/2,y:r-a/2+d.height+E},{x:n+g/2,y:r-a/2+d.height+E},{x:n+g/2,y:r+a/2},{x:n-g/2,y:r+a/2},{x:n-g/2,y:r-a/2+d.height+E},{x:n-d.width/2,y:r-a/2+d.height+E}]:[{x:n-g/2,y:r-a/2},{x:n+g/2,y:r-a/2},{x:n+g/2,y:r-a/2+h},{x:n+d.width/2,y:r-a/2+h},{x:n+d.width/2/2,y:r+a/2},{x:n-d.width/2,y:r+a/2},{x:n-d.width/2,y:r-a/2+h},{x:n-g/2,y:r-a/2+h}],J.polygon(t,o,e)},u}a(Ft,`iconRounded`);async function It(e,t,{config:{themeVariables:n,flowchart:r}}){let{labelStyles:a}=x(t);t.labelStyle=a;let o=t.assetHeight??48,s=t.assetWidth??48,c=Math.max(o,s),l=r?.wrappingWidth;t.width=Math.max(c,l??0);let{shapeSvg:u,bbox:d,halfPadding:f,label:p}=await H(e,t,`icon-shape default`),m=t.pos===`t`,h=c+f*2,g=c+f*2,{nodeBorder:_,mainBkg:y}=n,{stylesMap:S}=C(t),w=-g/2,T=-h/2,E=t.label?8:0,D=V.svg(u),O=b(t,{});t.look!==`handDrawn`&&(O.roughness=0,O.fillStyle=`solid`),O.stroke=S.get(`fill`)??y;let k=D.path(q(w,T,g,h,.1),O),A=Math.max(g,d.width),j=h+d.height+E,M=D.rectangle(-A/2,-j/2,A,j,{...O,fill:`transparent`,stroke:`none`}),N=u.insert(()=>k,`:first-child`),P=u.insert(()=>M);if(t.icon){let e=u.append(`g`);e.html(`<g>${await v(t.icon,{height:c,width:c,fallbackPrefix:``})}</g>`);let n=e.node().getBBox(),r=n.width,i=n.height,a=n.x,o=n.y;e.attr(`transform`,`translate(${-r/2-a},${m?d.height/2+E/2-i/2-o:-d.height/2-E/2-i/2-o})`),e.attr(`style`,`color: ${S.get(`stroke`)??_};`)}return p.attr(`transform`,`translate(${-d.width/2-(d.x-(d.left??0))},${m?-j/2:j/2-d.height})`),N.attr(`transform`,`translate(0,${m?d.height/2+E/2:-d.height/2-E/2})`),U(t,P),t.intersect=function(e){if(i.info(`iconSquare intersect`,t,e),!t.label)return J.rect(t,e);let n=t.x??0,r=t.y??0,a=t.height??0,o=[];return o=m?[{x:n-d.width/2,y:r-a/2},{x:n+d.width/2,y:r-a/2},{x:n+d.width/2,y:r-a/2+d.height+E},{x:n+g/2,y:r-a/2+d.height+E},{x:n+g/2,y:r+a/2},{x:n-g/2,y:r+a/2},{x:n-g/2,y:r-a/2+d.height+E},{x:n-d.width/2,y:r-a/2+d.height+E}]:[{x:n-g/2,y:r-a/2},{x:n+g/2,y:r-a/2},{x:n+g/2,y:r-a/2+h},{x:n+d.width/2,y:r-a/2+h},{x:n+d.width/2/2,y:r+a/2},{x:n-d.width/2,y:r+a/2},{x:n-d.width/2,y:r-a/2+h},{x:n-g/2,y:r-a/2+h}],J.polygon(t,o,e)},u}a(It,`iconSquare`);async function Lt(e,t,{config:{flowchart:n}}){let r=new Image;r.src=t?.img??``,await r.decode();let a=Number(r.naturalWidth.toString().replace(`px`,``)),o=Number(r.naturalHeight.toString().replace(`px`,``));t.imageAspectRatio=a/o;let{labelStyles:s}=x(t);t.labelStyle=s;let c=n?.wrappingWidth;t.defaultWidth=n?.wrappingWidth;let l=Math.max(t.label?c??0:0,t?.assetWidth??a),u=t.constraint===`on`&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:l,d=t.constraint===`on`?u/t.imageAspectRatio:t?.assetHeight??o;t.width=Math.max(u,c??0);let{shapeSvg:f,bbox:p,label:m}=await H(e,t,`image-shape default`),h=t.pos===`t`,g=-u/2,_=-d/2,v=t.label?8:0,y=V.svg(f),S=b(t,{});t.look!==`handDrawn`&&(S.roughness=0,S.fillStyle=`solid`);let C=y.rectangle(g,_,u,d,S),w=Math.max(u,p.width),T=d+p.height+v,E=y.rectangle(-w/2,-T/2,w,T,{...S,fill:`none`,stroke:`none`}),D=f.insert(()=>C,`:first-child`),O=f.insert(()=>E);if(t.img){let e=f.append(`image`);e.attr(`href`,t.img),e.attr(`width`,u),e.attr(`height`,d),e.attr(`preserveAspectRatio`,`none`),e.attr(`transform`,`translate(${-u/2},${h?T/2-d:-T/2})`)}return m.attr(`transform`,`translate(${-p.width/2-(p.x-(p.left??0))},${h?-d/2-p.height/2-v/2:d/2-p.height/2+v/2})`),D.attr(`transform`,`translate(0,${h?p.height/2+v/2:-p.height/2-v/2})`),U(t,O),t.intersect=function(e){if(i.info(`iconSquare intersect`,t,e),!t.label)return J.rect(t,e);let n=t.x??0,r=t.y??0,a=t.height??0,o=[];return o=h?[{x:n-p.width/2,y:r-a/2},{x:n+p.width/2,y:r-a/2},{x:n+p.width/2,y:r-a/2+p.height+v},{x:n+u/2,y:r-a/2+p.height+v},{x:n+u/2,y:r+a/2},{x:n-u/2,y:r+a/2},{x:n-u/2,y:r-a/2+p.height+v},{x:n-p.width/2,y:r-a/2+p.height+v}]:[{x:n-u/2,y:r-a/2},{x:n+u/2,y:r-a/2},{x:n+u/2,y:r-a/2+d},{x:n+p.width/2,y:r-a/2+d},{x:n+p.width/2/2,y:r+a/2},{x:n-p.width/2,y:r+a/2},{x:n-p.width/2,y:r-a/2+d},{x:n-u/2,y:r-a/2+d}],J.polygon(t,o,e)},f}a(Lt,`imageSquare`);async function Rt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(a.width+(t.padding??0)*2,t?.width??0),s=Math.max(a.height+(t.padding??0)*2,t?.height??0),c=[{x:0,y:0},{x:o,y:0},{x:o+3*s/6,y:-s},{x:-3*s/6,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=V.svg(i),n=b(t,{}),r=G(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=Y(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,U(t,l),t.intersect=function(e){return J.polygon(t,c,e)},i}a(Rt,`inv_trapezoid`);async function zt(e,t,n){let{labelStyles:i,nodeStyles:a}=x(t);t.labelStyle=i;let{shapeSvg:o,bbox:s}=await H(e,t,W(t)),c=Math.max(s.width+n.labelPaddingX*2,t?.width||0),l=Math.max(s.height+n.labelPaddingY*2,t?.height||0),u=-c/2,d=-l/2,f,{rx:p,ry:m}=t,{cssStyles:h}=t;if(n?.rx&&n.ry&&(p=n.rx,m=n.ry),t.look===`handDrawn`){let e=V.svg(o),n=b(t,{}),i=p||m?e.path(q(u,d,c,l,p||0),n):e.rectangle(u,d,c,l,n);f=o.insert(()=>i,`:first-child`),f.attr(`class`,`basic label-container`).attr(`style`,r(h))}else f=o.insert(`rect`,`:first-child`),f.attr(`class`,`basic label-container`).attr(`style`,a).attr(`rx`,r(p)).attr(`ry`,r(m)).attr(`x`,u).attr(`y`,d).attr(`width`,c).attr(`height`,l);return U(t,f),t.calcIntersect=function(e,t){return J.rect(e,t)},t.intersect=function(e){return J.rect(t,e)},o}a(zt,`drawRect`);async function Bt(e,t){let{shapeSvg:n,bbox:r,label:i}=await H(e,t,`label`),a=n.insert(`rect`,`:first-child`);return a.attr(`width`,.1).attr(`height`,.1),n.attr(`class`,`label edgeLabel`),i.attr(`transform`,`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),U(t,a),t.intersect=function(e){return J.rect(t,e)},n}a(Bt,`labelRect`);async function Vt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(a.width+(t.padding??0),t?.width??0),s=Math.max(a.height+(t.padding??0),t?.height??0),c=[{x:0,y:0},{x:o+3*s/6,y:0},{x:o,y:-s},{x:-(3*s)/6,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=V.svg(i),n=b(t,{}),r=G(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=Y(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,U(t,l),t.intersect=function(e){return J.polygon(t,c,e)},i}a(Vt,`lean_left`);async function Ht(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(a.width+(t.padding??0),t?.width??0),s=Math.max(a.height+(t.padding??0),t?.height??0),c=[{x:-3*s/6,y:0},{x:o,y:0},{x:o+3*s/6,y:-s},{x:0,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=V.svg(i),n=b(t,{}),r=G(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=Y(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,U(t,l),t.intersect=function(e){return J.polygon(t,c,e)},i}a(Ht,`lean_right`);function Ut(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.label=``,t.labelStyle=n;let a=e.insert(`g`).attr(`class`,W(t)).attr(`id`,t.domId??t.id),{cssStyles:o}=t,s=Math.max(35,t?.width??0),c=Math.max(35,t?.height??0),l=[{x:s,y:0},{x:0,y:c+7/2},{x:s-14,y:c+7/2},{x:0,y:2*c},{x:s,y:c-7/2},{x:14,y:c-7/2}],u=V.svg(a),d=b(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=G(l),p=u.path(f,d),m=a.insert(()=>p,`:first-child`);return o&&t.look!==`handDrawn`&&m.selectAll(`path`).attr(`style`,o),r&&t.look!==`handDrawn`&&m.selectAll(`path`).attr(`style`,r),m.attr(`transform`,`translate(-${s/2},${-c})`),U(t,m),t.intersect=function(e){return i.info(`lightningBolt intersect`,t,e),J.polygon(t,l,e)},a}a(Ut,`lightningBolt`);var Wt=a((e,t,n,r,i,a,o)=>[`M${e},${t+a}`,`a${i},${a} 0,0,0 ${n},0`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+a+o}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createCylinderPathD`),Gt=a((e,t,n,r,i,a,o)=>[`M${e},${t+a}`,`M${e+n},${t+a}`,`a${i},${a} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${a} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+a+o}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createOuterCylinderPathD`),Kt=a((e,t,n,r,i,a)=>[`M${e-n/2},${-r/2}`,`a${i},${a} 0,0,0 ${n},0`].join(` `),`createInnerCylinderPathD`);async function qt(e,t){let{labelStyles:n,nodeStyles:i}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o,label:s}=await H(e,t,W(t)),c=Math.max(o.width+(t.padding??0),t.width??0),l=c/2,u=l/(2.5+c/50),d=Math.max(o.height+u+(t.padding??0),t.height??0),f=d*.1,p,{cssStyles:m}=t;if(t.look===`handDrawn`){let e=V.svg(a),n=Gt(0,0,c,d,l,u,f),r=Kt(0,u,c,d,l,u),i=b(t,{}),o=e.path(n,i),s=e.path(r,i);a.insert(()=>s,`:first-child`).attr(`class`,`line`),p=a.insert(()=>o,`:first-child`),p.attr(`class`,`basic label-container`),m&&p.attr(`style`,m)}else{let e=Wt(0,0,c,d,l,u,f);p=a.insert(`path`,`:first-child`).attr(`d`,e).attr(`class`,`basic label-container`).attr(`style`,r(m)).attr(`style`,i)}return p.attr(`label-offset-y`,u),p.attr(`transform`,`translate(${-c/2}, ${-(d/2+u)})`),U(t,p),s.attr(`transform`,`translate(${-(o.width/2)-(o.x-(o.left??0))}, ${-(o.height/2)+u-(o.y-(o.top??0))})`),t.intersect=function(e){let n=J.rect(t,e),r=n.x-(t.x??0);if(l!=0&&(Math.abs(r)<(t.width??0)/2||Math.abs(r)==(t.width??0)/2&&Math.abs(n.y-(t.y??0))>(t.height??0)/2-u)){let i=u*u*(1-r*r/(l*l));i>0&&(i=Math.sqrt(i)),i=u-i,e.y-(t.y??0)>0&&(i=-i),n.y+=i}return n},a}a(qt,`linedCylinder`);async function Jt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/4,u=c+l,{cssStyles:d}=t,f=V.svg(i),p=b(t,{});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=[{x:-s/2-s/2*.1,y:-u/2},{x:-s/2-s/2*.1,y:u/2},...K(-s/2-s/2*.1,u/2,s/2+s/2*.1,u/2,l,.8),{x:s/2+s/2*.1,y:-u/2},{x:-s/2-s/2*.1,y:-u/2},{x:-s/2,y:-u/2},{x:-s/2,y:u/2*1.1},{x:-s/2,y:-u/2}],h=f.polygon(m.map(e=>[e.x,e.y]),p),g=i.insert(()=>h,`:first-child`);return g.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&g.selectAll(`path`).attr(`style`,r),g.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)+s/2*.1/2-(a.x-(a.left??0))},${-c/2+(t.padding??0)-l/2-(a.y-(a.top??0))})`),U(t,g),t.intersect=function(e){return J.polygon(t,m,e)},i}a(Jt,`linedWaveEdgedRect`);async function Yt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=-s/2,u=-c/2,{cssStyles:d}=t,f=V.svg(i),p=b(t,{}),m=[{x:l-5,y:u+5},{x:l-5,y:u+c+5},{x:l+s-5,y:u+c+5},{x:l+s-5,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u+c-5},{x:l+s+5,y:u+c-5},{x:l+s+5,y:u-5},{x:l+5,y:u-5},{x:l+5,y:u},{x:l,y:u},{x:l,y:u+5}],h=[{x:l,y:u+5},{x:l+s-5,y:u+5},{x:l+s-5,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u},{x:l,y:u}];t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let g=G(m),_=f.path(g,p),v=G(h),y=f.path(v,{...p,fill:`none`}),S=i.insert(()=>y,`:first-child`);return S.insert(()=>_,`:first-child`),S.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&S.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&S.selectAll(`path`).attr(`style`,r),o.attr(`transform`,`translate(${-(a.width/2)-5-(a.x-(a.left??0))}, ${-(a.height/2)+5-(a.y-(a.top??0))})`),U(t,S),t.intersect=function(e){return J.polygon(t,m,e)},i}a(Yt,`multiRect`);async function Xt(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/4,u=c+l,d=-s/2,f=-u/2,{cssStyles:p}=t,m=K(d-5,f+u+5,d+s-5,f+u+5,l,.8),h=m?.[m.length-1],g=[{x:d-5,y:f+5},{x:d-5,y:f+u+5},...m,{x:d+s-5,y:h.y-5},{x:d+s,y:h.y-5},{x:d+s,y:h.y-10},{x:d+s+5,y:h.y-10},{x:d+s+5,y:f-5},{x:d+5,y:f-5},{x:d+5,y:f},{x:d,y:f},{x:d,y:f+5}],_=[{x:d,y:f+5},{x:d+s-5,y:f+5},{x:d+s-5,y:h.y-5},{x:d+s,y:h.y-5},{x:d+s,y:f},{x:d,y:f}],v=V.svg(i),y=b(t,{});t.look!==`handDrawn`&&(y.roughness=0,y.fillStyle=`solid`);let S=G(g),C=v.path(S,y),w=G(_),T=v.path(w,y),E=i.insert(()=>C,`:first-child`);return E.insert(()=>T),E.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&E.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&E.selectAll(`path`).attr(`style`,r),E.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-(a.width/2)-5-(a.x-(a.left??0))}, ${-(a.height/2)+5-l/2-(a.y-(a.top??0))})`),U(t,E),t.intersect=function(e){return J.polygon(t,g,e)},i}a(Xt,`multiWaveEdgedRectangle`);async function Zt(e,t,{config:{themeVariables:n}}){let{labelStyles:r,nodeStyles:i}=x(t);t.labelStyle=r,t.useHtmlLabels||g().flowchart?.htmlLabels!==!1||(t.centerLabel=!0);let{shapeSvg:a,bbox:o,label:s}=await H(e,t,W(t)),c=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),u=-c/2,d=-l/2,{cssStyles:f}=t,p=V.svg(a),m=b(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=p.rectangle(u,d,c,l,m),_=a.insert(()=>h,`:first-child`);return _.attr(`class`,`basic label-container`),f&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,f),i&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,i),s.attr(`transform`,`translate(${-o.width/2-(o.x-(o.left??0))}, ${-(o.height/2)-(o.y-(o.top??0))})`),U(t,_),t.intersect=function(e){return J.rect(t,e)},a}a(Zt,`note`);var Qt=a((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,`Z`].join(` `),`createDecisionBoxPathD`);async function $t(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=a.width+t.padding+(a.height+t.padding),s=.5,c=[{x:o/2,y:0},{x:o,y:-o/2},{x:o/2,y:-o},{x:0,y:-o/2}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=V.svg(i),n=b(t,{}),r=Qt(0,0,o),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2+s}, ${o/2})`),u&&l.attr(`style`,u)}else l=Y(i,o,o,c),l.attr(`transform`,`translate(${-o/2+s}, ${o/2})`);return r&&l.attr(`style`,r),U(t,l),t.calcIntersect=function(e,t){let n=e.width,r=[{x:n/2,y:0},{x:n,y:-n/2},{x:n/2,y:-n},{x:0,y:-n/2}],i=J.polygon(e,r,t);return{x:i.x-.5,y:i.y-.5}},t.intersect=function(e){return this.calcIntersect(t,e)},i}a($t,`question`);async function en(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0),t?.width??0),c=Math.max(a.height+(t.padding??0),t?.height??0),l=-s/2,u=-c/2,d=u/2,f=[{x:l+d,y:u},{x:l,y:0},{x:l+d,y:-u},{x:-l,y:-u},{x:-l,y:u}],{cssStyles:p}=t,m=V.svg(i),h=b(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=G(f),_=m.path(g,h),v=i.insert(()=>_,`:first-child`);return v.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&v.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&v.selectAll(`path`).attr(`style`,r),v.attr(`transform`,`translate(${-d/2},0)`),o.attr(`transform`,`translate(${-d/2-a.width/2-(a.x-(a.left??0))}, ${-(a.height/2)-(a.y-(a.top??0))})`),U(t,v),t.intersect=function(e){return J.polygon(t,f,e)},i}a(en,`rect_left_inv_arrow`);async function tn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let a;a=t.cssClasses?`node `+t.cssClasses:`node default`;let s=e.insert(`g`).attr(`class`,a).attr(`id`,t.domId||t.id),c=s.insert(`g`),l=s.insert(`g`).attr(`class`,`label`).attr(`style`,r),u=t.description,d=t.label,p=l.node().appendChild(await qe(d,t.labelStyle,!0,!0)),h={width:0,height:0};if(m(f()?.flowchart?.htmlLabels)){let e=p.children[0],t=o(p);h=e.getBoundingClientRect(),t.attr(`width`,h.width),t.attr(`height`,h.height)}i.info(`Text 2`,u);let g=u||[],_=p.getBBox(),v=l.node().appendChild(await qe(g.join?g.join(`<br/>`):g,t.labelStyle,!0,!0)),y=v.children[0],S=o(v);h=y.getBoundingClientRect(),S.attr(`width`,h.width),S.attr(`height`,h.height);let C=(t.padding||0)/2;o(v).attr(`transform`,`translate( `+(h.width>_.width?0:(_.width-h.width)/2)+`, `+(_.height+C+5)+`)`),o(p).attr(`transform`,`translate( `+(h.width<_.width?0:-(_.width-h.width)/2)+`, 0)`),h=l.node().getBBox(),l.attr(`transform`,`translate(`+-h.width/2+`, `+(-h.height/2-C+3)+`)`);let w=h.width+(t.padding||0),T=h.height+(t.padding||0),E=-h.width/2-C,D=-h.height/2-C,O,k;if(t.look===`handDrawn`){let e=V.svg(s),n=b(t,{}),r=e.path(q(E,D,w,T,t.rx||0),n),a=e.line(-h.width/2-C,-h.height/2-C+_.height+C,h.width/2+C,-h.height/2-C+_.height+C,n);k=s.insert(()=>(i.debug(`Rough node insert CXC`,r),a),`:first-child`),O=s.insert(()=>(i.debug(`Rough node insert CXC`,r),r),`:first-child`)}else O=c.insert(`rect`,`:first-child`),k=c.insert(`line`),O.attr(`class`,`outer title-state`).attr(`style`,r).attr(`x`,-h.width/2-C).attr(`y`,-h.height/2-C).attr(`width`,h.width+(t.padding||0)).attr(`height`,h.height+(t.padding||0)),k.attr(`class`,`divider`).attr(`x1`,-h.width/2-C).attr(`x2`,h.width/2+C).attr(`y1`,-h.height/2-C+_.height+C).attr(`y2`,-h.height/2-C+_.height+C);return U(t,O),t.intersect=function(e){return J.rect(t,e)},s}a(tn,`rectWithTitle`);function nn(e,t,n,r,i,a,o){let s=(e+n)/2,c=(t+r)/2,l=Math.atan2(r-t,n-e),u=(n-e)/2,d=(r-t)/2,f=u/i,p=d/a,m=Math.sqrt(f**2+p**2);if(m>1)throw Error(`The given radii are too small to create an arc between the points.`);let h=Math.sqrt(1-m**2),g=s+h*a*Math.sin(l)*(o?-1:1),_=c-h*i*Math.cos(l)*(o?-1:1),v=Math.atan2((t-_)/a,(e-g)/i),y=Math.atan2((r-_)/a,(n-g)/i)-v;o&&y<0&&(y+=2*Math.PI),!o&&y>0&&(y-=2*Math.PI);let b=[];for(let e=0;e<20;e++){let t=v+e/19*y,n=g+i*Math.cos(t),r=_+a*Math.sin(t);b.push({x:n,y:r})}return b}a(nn,`generateArcPoints`);async function rn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=t?.padding??0,s=t?.padding??0,c=(t?.width?t?.width:a.width)+o*2,l=(t?.height?t?.height:a.height)+s*2,u=t.radius||5,d=t.taper||5,{cssStyles:f}=t,p=V.svg(i),m=b(t,{});t.stroke&&(m.stroke=t.stroke),t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let h=[{x:-c/2+d,y:-l/2},{x:c/2-d,y:-l/2},...nn(c/2-d,-l/2,c/2,-l/2+d,u,u,!0),{x:c/2,y:-l/2+d},{x:c/2,y:l/2-d},...nn(c/2,l/2-d,c/2-d,l/2,u,u,!0),{x:c/2-d,y:l/2},{x:-c/2+d,y:l/2},...nn(-c/2+d,l/2,-c/2,l/2-d,u,u,!0),{x:-c/2,y:l/2-d},{x:-c/2,y:-l/2+d},...nn(-c/2,-l/2+d,-c/2+d,-l/2,u,u,!0)],g=G(h),_=p.path(g,m),v=i.insert(()=>_,`:first-child`);return v.attr(`class`,`basic label-container outer-path`),f&&t.look!==`handDrawn`&&v.selectChildren(`path`).attr(`style`,f),r&&t.look!==`handDrawn`&&v.selectChildren(`path`).attr(`style`,r),U(t,v),t.intersect=function(e){return J.polygon(t,h,e)},i}a(rn,`roundedRect`);async function an(e,t){let{labelStyles:n,nodeStyles:i}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o,label:s}=await H(e,t,W(t)),c=t?.padding??0,l=Math.max(o.width+(t.padding??0)*2,t?.width??0),u=Math.max(o.height+(t.padding??0)*2,t?.height??0),d=-o.width/2-c,f=-o.height/2-c,{cssStyles:p}=t,m=V.svg(a),h=b(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=[{x:d,y:f},{x:d+l+8,y:f},{x:d+l+8,y:f+u},{x:d-8,y:f+u},{x:d-8,y:f},{x:d,y:f},{x:d,y:f+u}],_=m.polygon(g.map(e=>[e.x,e.y]),h),v=a.insert(()=>_,`:first-child`);return v.attr(`class`,`basic label-container`).attr(`style`,r(p)),i&&t.look!==`handDrawn`&&v.selectAll(`path`).attr(`style`,i),p&&t.look!==`handDrawn`&&v.selectAll(`path`).attr(`style`,i),s.attr(`transform`,`translate(${-l/2+4+(t.padding??0)-(o.x-(o.left??0))},${-u/2+(t.padding??0)-(o.y-(o.top??0))})`),U(t,v),t.intersect=function(e){return J.rect(t,e)},a}a(an,`shadedProcess`);async function on(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=-s/2,u=-c/2,{cssStyles:d}=t,f=V.svg(i),p=b(t,{});t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let m=[{x:l,y:u},{x:l,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u-c/2}],h=G(m),g=f.path(h,p),_=i.insert(()=>g,`:first-child`);return _.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&_.selectChildren(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&_.selectChildren(`path`).attr(`style`,r),_.attr(`transform`,`translate(0, ${c/4})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)-(a.x-(a.left??0))}, ${-c/4+(t.padding??0)-(a.y-(a.top??0))})`),U(t,_),t.intersect=function(e){return J.polygon(t,m,e)},i}a(on,`slopedRect`);async function sn(e,t){return zt(e,t,{rx:0,ry:0,classes:``,labelPaddingX:t.labelPaddingX??(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1})}a(sn,`squareRect`);async function cn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=a.height+t.padding,s=a.width+o/4+t.padding,c=o/2,{cssStyles:l}=t,u=V.svg(i),d=b(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=[{x:-s/2+c,y:-o/2},{x:s/2-c,y:-o/2},...Ue(-s/2+c,0,c,50,90,270),{x:s/2-c,y:o/2},...Ue(s/2-c,0,c,50,270,450)],p=G(f),m=u.path(p,d),h=i.insert(()=>m,`:first-child`);return h.attr(`class`,`basic label-container outer-path`),l&&t.look!==`handDrawn`&&h.selectChildren(`path`).attr(`style`,l),r&&t.look!==`handDrawn`&&h.selectChildren(`path`).attr(`style`,r),U(t,h),t.intersect=function(e){return J.polygon(t,f,e)},i}a(cn,`stadium`);async function ln(e,t){return zt(e,t,{rx:5,ry:5,classes:`flowchart-node`})}a(ln,`state`);function un(e,t,{config:{themeVariables:n}}){let{labelStyles:r,nodeStyles:i}=x(t);t.labelStyle=r;let{cssStyles:a}=t,{lineColor:o,stateBorder:s,nodeBorder:c}=n,l=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),u=V.svg(l),d=b(t,{});t.look!==`handDrawn`&&(d.roughness=0,d.fillStyle=`solid`);let f=u.circle(0,0,14,{...d,stroke:o,strokeWidth:2}),p=s??c,m=u.circle(0,0,5,{...d,fill:p,stroke:p,strokeWidth:2,fillStyle:`solid`}),h=l.insert(()=>f,`:first-child`);return h.insert(()=>m),a&&h.selectAll(`path`).attr(`style`,a),i&&h.selectAll(`path`).attr(`style`,i),U(t,h),t.intersect=function(e){return J.circle(t,7,e)},l}a(un,`stateEnd`);function dn(e,t,{config:{themeVariables:n}}){let{lineColor:r}=n,i=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),a;if(t.look===`handDrawn`){let e=V.svg(i).circle(0,0,14,S(r));a=i.insert(()=>e),a.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14)}else a=i.insert(`circle`,`:first-child`),a.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14);return U(t,a),t.intersect=function(e){return J.circle(t,7,e)},i}a(dn,`stateStart`);async function fn(e,t){let{labelStyles:n,nodeStyles:i}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o}=await H(e,t,W(t)),s=(t?.padding||0)/2,c=o.width+t.padding,l=o.height+t.padding,u=-o.width/2-s,d=-o.height/2-s,f=[{x:0,y:0},{x:c,y:0},{x:c,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:c+8,y:0},{x:c+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look===`handDrawn`){let e=V.svg(a),n=b(t,{}),i=e.rectangle(u-8,d,c+16,l,n),o=e.line(u,d,u,d+l,n),s=e.line(u+c,d,u+c,d+l,n);a.insert(()=>o,`:first-child`),a.insert(()=>s,`:first-child`);let f=a.insert(()=>i,`:first-child`),{cssStyles:p}=t;f.attr(`class`,`basic label-container`).attr(`style`,r(p)),U(t,f)}else{let e=Y(a,c,l,f);i&&e.attr(`style`,i),U(t,e)}return t.intersect=function(e){return J.polygon(t,f,e)},a}a(fn,`subroutine`);async function pn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(a.width+(t.padding??0)*2,t?.width??0),s=Math.max(a.height+(t.padding??0)*2,t?.height??0),c=-o/2,l=-s/2,u=.2*s,d=.2*s,{cssStyles:f}=t,p=V.svg(i),m=b(t,{}),h=[{x:c-u/2,y:l},{x:c+o+u/2,y:l},{x:c+o+u/2,y:l+s},{x:c-u/2,y:l+s}],g=[{x:c+o-u/2,y:l+s},{x:c+o+u/2,y:l+s},{x:c+o+u/2,y:l+s-d}];t.look!==`handDrawn`&&(m.roughness=0,m.fillStyle=`solid`);let _=G(h),v=p.path(_,m),y=G(g),S=p.path(y,{...m,fillStyle:`solid`}),C=i.insert(()=>S,`:first-child`);return C.insert(()=>v,`:first-child`),C.attr(`class`,`basic label-container`),f&&t.look!==`handDrawn`&&C.selectAll(`path`).attr(`style`,f),r&&t.look!==`handDrawn`&&C.selectAll(`path`).attr(`style`,r),U(t,C),t.intersect=function(e){return J.polygon(t,h,e)},i}a(pn,`taggedRect`);async function mn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/4,u=.2*s,d=.2*c,f=c+l,{cssStyles:p}=t,m=V.svg(i),h=b(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=[{x:-s/2-s/2*.1,y:f/2},...K(-s/2-s/2*.1,f/2,s/2+s/2*.1,f/2,l,.8),{x:s/2+s/2*.1,y:-f/2},{x:-s/2-s/2*.1,y:-f/2}],_=-s/2+s/2*.1,v=-f/2-d*.4,y=[{x:_+s-u,y:(v+c)*1.4},{x:_+s,y:v+c-d},{x:_+s,y:(v+c)*.9},...K(_+s,(v+c)*1.3,_+s-u,(v+c)*1.5,-c*.03,.5)],S=G(g),C=m.path(S,h),w=G(y),T=m.path(w,{...h,fillStyle:`solid`}),E=i.insert(()=>T,`:first-child`);return E.insert(()=>C,`:first-child`),E.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&E.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&E.selectAll(`path`).attr(`style`,r),E.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)-(a.x-(a.left??0))},${-c/2+(t.padding??0)-l/2-(a.y-(a.top??0))})`),U(t,E),t.intersect=function(e){return J.polygon(t,g,e)},i}a(mn,`taggedWaveEdgedRectangle`);async function hn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(a.width+t.padding,t?.width||0),s=Math.max(a.height+t.padding,t?.height||0),c=-o/2,l=-s/2,u=i.insert(`rect`,`:first-child`);return u.attr(`class`,`text`).attr(`style`,r).attr(`rx`,0).attr(`ry`,0).attr(`x`,c).attr(`y`,l).attr(`width`,o).attr(`height`,s),U(t,u),t.intersect=function(e){return J.rect(t,e)},i}a(hn,`text`);var gn=a((e,t,n,r,i,a)=>`M${e},${t}
    a${i},${a} 0,0,1 0,${-r}
    l${n},0
    a${i},${a} 0,0,1 0,${r}
    M${n},${-r}
    a${i},${a} 0,0,0 0,${r}
    l${-n},0`,`createCylinderPathD`),_n=a((e,t,n,r,i,a)=>[`M${e},${t}`,`M${e+n},${t}`,`a${i},${a} 0,0,0 0,${-r}`,`l${-n},0`,`a${i},${a} 0,0,0 0,${r}`,`l${n},0`].join(` `),`createOuterCylinderPathD`),vn=a((e,t,n,r,i,a)=>[`M${e+n/2},${-r/2}`,`a${i},${a} 0,0,0 0,${r}`].join(` `),`createInnerCylinderPathD`);async function yn(e,t){let{labelStyles:n,nodeStyles:i}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o,label:s,halfPadding:c}=await H(e,t,W(t)),l=t.look===`neo`?c*2:c,u=o.height+l,d=u/2,f=d/(2.5+u/50),p=o.width+f+l,{cssStyles:m}=t,h;if(t.look===`handDrawn`){let e=V.svg(a),n=_n(0,0,p,u,f,d),r=vn(0,0,p,u,f,d),i=e.path(n,b(t,{})),o=e.path(r,b(t,{fill:`none`}));h=a.insert(()=>o,`:first-child`),h=a.insert(()=>i,`:first-child`),h.attr(`class`,`basic label-container`),m&&h.attr(`style`,m)}else{let e=gn(0,0,p,u,f,d);h=a.insert(`path`,`:first-child`).attr(`d`,e).attr(`class`,`basic label-container`).attr(`style`,r(m)).attr(`style`,i),h.attr(`class`,`basic label-container`),m&&h.selectAll(`path`).attr(`style`,m),i&&h.selectAll(`path`).attr(`style`,i)}return h.attr(`label-offset-x`,f),h.attr(`transform`,`translate(${-p/2}, ${u/2} )`),s.attr(`transform`,`translate(${-(o.width/2)-f-(o.x-(o.left??0))}, ${-(o.height/2)-(o.y-(o.top??0))})`),U(t,h),t.intersect=function(e){let n=J.rect(t,e),r=n.y-(t.y??0);if(d!=0&&(Math.abs(r)<(t.height??0)/2||Math.abs(r)==(t.height??0)/2&&Math.abs(n.x-(t.x??0))>(t.width??0)/2-f)){let i=f*f*(1-r*r/(d*d));i!=0&&(i=Math.sqrt(Math.abs(i))),i=f-i,e.x-(t.x??0)>0&&(i=-i),n.x+=i}return n},a}a(yn,`tiltedCylinder`);async function bn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=a.width+t.padding,s=a.height+t.padding,c=[{x:-3*s/6,y:0},{x:o+3*s/6,y:0},{x:o,y:-s},{x:0,y:-s}],l,{cssStyles:u}=t;if(t.look===`handDrawn`){let e=V.svg(i),n=b(t,{}),r=G(c),a=e.path(r,n);l=i.insert(()=>a,`:first-child`).attr(`transform`,`translate(${-o/2}, ${s/2})`),u&&l.attr(`style`,u)}else l=Y(i,o,s,c);return r&&l.attr(`style`,r),t.width=o,t.height=s,U(t,l),t.intersect=function(e){return J.polygon(t,c,e)},i}a(bn,`trapezoid`);async function xn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(60,a.width+(t.padding??0)*2,t?.width??0),s=Math.max(20,a.height+(t.padding??0)*2,t?.height??0),{cssStyles:c}=t,l=V.svg(i),u=b(t,{});t.look!==`handDrawn`&&(u.roughness=0,u.fillStyle=`solid`);let d=[{x:-o/2*.8,y:-s/2},{x:o/2*.8,y:-s/2},{x:o/2,y:-s/2*.6},{x:o/2,y:s/2},{x:-o/2,y:s/2},{x:-o/2,y:-s/2*.6}],f=G(d),p=l.path(f,u),m=i.insert(()=>p,`:first-child`);return m.attr(`class`,`basic label-container`),c&&t.look!==`handDrawn`&&m.selectChildren(`path`).attr(`style`,c),r&&t.look!==`handDrawn`&&m.selectChildren(`path`).attr(`style`,r),U(t,m),t.intersect=function(e){return J.polygon(t,d,e)},i}a(xn,`trapezoidalPentagon`);async function Sn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:a,bbox:o,label:s}=await H(e,t,W(t)),c=m(f().flowchart?.htmlLabels),l=o.width+(t.padding??0),u=l+o.height,d=l+o.height,p=[{x:0,y:0},{x:d,y:0},{x:d/2,y:-u}],{cssStyles:h}=t,g=V.svg(a),_=b(t,{});t.look!==`handDrawn`&&(_.roughness=0,_.fillStyle=`solid`);let v=G(p),y=g.path(v,_),S=a.insert(()=>y,`:first-child`).attr(`transform`,`translate(${-u/2}, ${u/2})`);return h&&t.look!==`handDrawn`&&S.selectChildren(`path`).attr(`style`,h),r&&t.look!==`handDrawn`&&S.selectChildren(`path`).attr(`style`,r),t.width=l,t.height=u,U(t,S),s.attr(`transform`,`translate(${-o.width/2-(o.x-(o.left??0))}, ${u/2-(o.height+(t.padding??0)/(c?2:1)-(o.y-(o.top??0)))})`),t.intersect=function(e){return i.info(`Triangle intersect`,t,p,e),J.polygon(t,p,e)},a}a(Sn,`triangle`);async function Cn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=c/8,u=c+l,{cssStyles:d}=t,f=70-s,p=f>0?f/2:0,m=V.svg(i),h=b(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=[{x:-s/2-p,y:u/2},...K(-s/2-p,u/2,s/2+p,u/2,l,.8),{x:s/2+p,y:-u/2},{x:-s/2-p,y:-u/2}],_=G(g),v=m.path(_,h),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),y.attr(`transform`,`translate(0,${-l/2})`),o.attr(`transform`,`translate(${-s/2+(t.padding??0)-(a.x-(a.left??0))},${-c/2+(t.padding??0)-l-(a.y-(a.top??0))})`),U(t,y),t.intersect=function(e){return J.polygon(t,g,e)},i}a(Cn,`waveEdgedRectangle`);async function wn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a}=await H(e,t,W(t)),o=Math.max(a.width+(t.padding??0)*2,t?.width??0),s=Math.max(a.height+(t.padding??0)*2,t?.height??0),c=o/s,l=o,u=s;l>u*c?u=l/c:l=u*c,l=Math.max(l,100),u=Math.max(u,50);let d=Math.min(u*.2,u/4),f=u+d*2,{cssStyles:p}=t,m=V.svg(i),h=b(t,{});t.look!==`handDrawn`&&(h.roughness=0,h.fillStyle=`solid`);let g=[{x:-l/2,y:f/2},...K(-l/2,f/2,l/2,f/2,d,1),{x:l/2,y:-f/2},...K(l/2,-f/2,-l/2,-f/2,d,-1)],_=G(g),v=m.path(_,h),y=i.insert(()=>v,`:first-child`);return y.attr(`class`,`basic label-container`),p&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,p),r&&t.look!==`handDrawn`&&y.selectAll(`path`).attr(`style`,r),U(t,y),t.intersect=function(e){return J.polygon(t,g,e)},i}a(wn,`waveRectangle`);async function Tn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,label:o}=await H(e,t,W(t)),s=Math.max(a.width+(t.padding??0)*2,t?.width??0),c=Math.max(a.height+(t.padding??0)*2,t?.height??0),l=-s/2,u=-c/2,{cssStyles:d}=t,f=V.svg(i),p=b(t,{}),m=[{x:l-5,y:u-5},{x:l-5,y:u+c},{x:l+s,y:u+c},{x:l+s,y:u-5}],h=`M${l-5},${u-5} L${l+s},${u-5} L${l+s},${u+c} L${l-5},${u+c} L${l-5},${u-5}
                M${l-5},${u} L${l+s},${u}
                M${l},${u-5} L${l},${u+c}`;t.look!==`handDrawn`&&(p.roughness=0,p.fillStyle=`solid`);let g=f.path(h,p),_=i.insert(()=>g,`:first-child`);return _.attr(`transform`,`translate(${5/2}, ${5/2})`),_.attr(`class`,`basic label-container`),d&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,d),r&&t.look!==`handDrawn`&&_.selectAll(`path`).attr(`style`,r),o.attr(`transform`,`translate(${-(a.width/2)+5/2-(a.x-(a.left??0))}, ${-(a.height/2)+5/2-(a.y-(a.top??0))})`),U(t,_),t.intersect=function(e){return J.polygon(t,m,e)},i}a(Tn,`windowPane`);async function En(e,t){let r=t;if(r.alias&&(t.label=r.alias),t.look===`handDrawn`){let{themeVariables:n}=g(),{background:r}=n;await En(e,{...t,id:t.id+`-background`,look:`default`,cssStyles:[`stroke: none`,`fill: ${r}`]})}let i=g();t.useHtmlLabels=i.htmlLabels;let a=i.er?.diagramPadding??10,s=i.er?.entityPadding??6,{cssStyles:c}=t,{labelStyles:l,nodeStyles:u}=x(t);if(r.attributes.length===0&&t.label){let r={rx:0,ry:0,labelPaddingX:a,labelPaddingY:a*1.5,classes:``};n(t.label,i)+r.labelPaddingX*2<i.er.minEntityWidth&&(t.width=i.er.minEntityWidth);let o=await zt(e,t,r);if(!m(i.htmlLabels)){let e=o.select(`text`),t=e.node()?.getBBox();e.attr(`transform`,`translate(${-t.width/2}, 0)`)}return o}i.htmlLabels||(a*=1.25,s*=1.25);let d=W(t);d||=`node default`;let f=e.insert(`g`).attr(`class`,d).attr(`id`,t.domId||t.id),p=await Dn(f,t.label??``,i,0,0,[`name`],l);p.height+=s;let h=0,_=[],v=[],y=0,S=0,C=0,w=0,T=!0,E=!0;for(let e of r.attributes){let t=await Dn(f,e.type,i,0,h,[`attribute-type`],l);y=Math.max(y,t.width+a);let n=await Dn(f,e.name,i,0,h,[`attribute-name`],l);S=Math.max(S,n.width+a);let r=await Dn(f,e.keys.join(),i,0,h,[`attribute-keys`],l);C=Math.max(C,r.width+a);let o=await Dn(f,e.comment,i,0,h,[`attribute-comment`],l);w=Math.max(w,o.width+a);let c=Math.max(t.height,n.height,r.height,o.height)+s;v.push({yOffset:h,rowHeight:c}),h+=c}let D=4;C<=a&&(T=!1,C=0,D--),w<=a&&(E=!1,w=0,D--);let O=f.node().getBBox();if(p.width+a*2-(y+S+C+w)>0){let e=p.width+a*2-(y+S+C+w);y+=e/D,S+=e/D,C>0&&(C+=e/D),w>0&&(w+=e/D)}let k=y+S+C+w,A=V.svg(f),j=b(t,{});t.look!==`handDrawn`&&(j.roughness=0,j.fillStyle=`solid`);let M=0;v.length>0&&(M=v.reduce((e,t)=>e+(t?.rowHeight??0),0));let N=Math.max(O.width+a*2,t?.width||0,k),P=Math.max((M??0)+p.height,t?.height||0),F=-N/2,I=-P/2;f.selectAll(`g:not(:first-child)`).each((e,t,n)=>{let r=o(n[t]),i=r.attr(`transform`),c=0,l=0;if(i){let e=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(i);e&&(c=parseFloat(e[1]),l=parseFloat(e[2]),r.attr(`class`).includes(`attribute-name`)?c+=y:r.attr(`class`).includes(`attribute-keys`)?c+=y+S:r.attr(`class`).includes(`attribute-comment`)&&(c+=y+S+C))}r.attr(`transform`,`translate(${F+a/2+c}, ${l+I+p.height+s/2})`)}),f.select(`.name`).attr(`transform`,`translate(`+-p.width/2+`, `+(I+s/2)+`)`);let ee=A.rectangle(F,I,N,P,j),te=f.insert(()=>ee,`:first-child`).attr(`style`,c.join(``)),{themeVariables:ne}=g(),{rowEven:re,rowOdd:ie,nodeBorder:ae}=ne;_.push(0);for(let[e,t]of v.entries()){let n=(e+1)%2==0&&t.yOffset!==0,r=A.rectangle(F,p.height+I+t?.yOffset,N,t?.rowHeight,{...j,fill:n?re:ie,stroke:ae});f.insert(()=>r,`g.label`).attr(`style`,c.join(``)).attr(`class`,`row-rect-${n?`even`:`odd`}`)}let L=A.line(F,p.height+I,N+F,p.height+I,j);f.insert(()=>L).attr(`class`,`divider`),L=A.line(y+F,p.height+I,y+F,P+I,j),f.insert(()=>L).attr(`class`,`divider`),T&&(L=A.line(y+S+F,p.height+I,y+S+F,P+I,j),f.insert(()=>L).attr(`class`,`divider`)),E&&(L=A.line(y+S+C+F,p.height+I,y+S+C+F,P+I,j),f.insert(()=>L).attr(`class`,`divider`));for(let e of _)L=A.line(F,p.height+I+e,N+F,p.height+I+e,j),f.insert(()=>L).attr(`class`,`divider`);if(U(t,te),u&&t.look!==`handDrawn`){let e=u.split(`;`)?.filter(e=>e.includes(`stroke`))?.map(e=>`${e}`).join(`; `);f.selectAll(`path`).attr(`style`,e??``),f.selectAll(`.row-rect-even path`).attr(`style`,u)}return t.intersect=function(e){return J.rect(t,e)},f}a(En,`erBox`);async function Dn(e,t,r,i=0,a=0,c=[],l=``){let u=e.insert(`g`).attr(`class`,`label ${c.join(` `)}`).attr(`transform`,`translate(${i}, ${a})`).attr(`style`,l);t!==s(t)&&(t=s(t),t=t.replaceAll(`<`,`&lt;`).replaceAll(`>`,`&gt;`));let d=u.node().appendChild(await _(u,t,{width:n(t,r)+100,style:l,useHtmlLabels:r.htmlLabels},r));if(t.includes(`&lt;`)||t.includes(`&gt;`)){let e=d.children[0];for(e.textContent=e.textContent.replaceAll(`&lt;`,`<`).replaceAll(`&gt;`,`>`);e.childNodes[0];)e=e.childNodes[0],e.textContent=e.textContent.replaceAll(`&lt;`,`<`).replaceAll(`&gt;`,`>`)}let f=d.getBBox();if(m(r.htmlLabels)){let e=d.children[0];e.style.textAlign=`start`;let t=o(d);f=e.getBoundingClientRect(),t.attr(`width`,f.width),t.attr(`height`,f.height)}return f}a(Dn,`addText`);async function On(e,t,n,r,i=n.class.padding??12){let a=r?0:3,o=e.insert(`g`).attr(`class`,W(t)).attr(`id`,t.domId||t.id),s=null,c=null,l=null,u=null,d=0,f=0,p=0;if(s=o.insert(`g`).attr(`class`,`annotation-group text`),t.annotations.length>0){let e=t.annotations[0];await kn(s,{text:`\xAB${e}\xBB`},0),d=s.node().getBBox().height}c=o.insert(`g`).attr(`class`,`label-group text`),await kn(c,t,0,[`font-weight: bolder`]);let m=c.node().getBBox();f=m.height,l=o.insert(`g`).attr(`class`,`members-group text`);let h=0;for(let e of t.members){let t=await kn(l,e,h,[e.parseClassifier()]);h+=t+a}p=l.node().getBBox().height,p<=0&&(p=i/2),u=o.insert(`g`).attr(`class`,`methods-group text`);let g=0;for(let e of t.methods){let t=await kn(u,e,g,[e.parseClassifier()]);g+=t+a}let _=o.node().getBBox();if(s!==null){let e=s.node().getBBox();s.attr(`transform`,`translate(${-e.width/2})`)}return c.attr(`transform`,`translate(${-m.width/2}, ${d})`),_=o.node().getBBox(),l.attr(`transform`,`translate(0, ${d+f+i*2})`),_=o.node().getBBox(),u.attr(`transform`,`translate(0, ${d+f+(p?p+i*4:i*2)})`),_=o.node().getBBox(),{shapeSvg:o,bbox:_}}a(On,`textHelper`);async function kn(t,r,i,s=[]){let c=t.insert(`g`).attr(`class`,`label`).attr(`style`,s.join(`; `)),u=g(),f=`useHtmlLabels`in r?r.useHtmlLabels:m(u.htmlLabels)??!0,p=``;p=`text`in r?r.text:r.label,!f&&p.startsWith(`\\`)&&(p=p.substring(1)),d(p)&&(f=!0);let h=await _(c,l(e(p)),{width:n(p,u)+50,classes:`markdown-node-label`,useHtmlLabels:f},u),v,y=1;if(f){let e=h.children[0],t=o(h);y=e.innerHTML.split(`<br>`).length,e.innerHTML.includes(`</math>`)&&(y+=e.innerHTML.split(`<mrow>`).length-1);let n=e.getElementsByTagName(`img`);if(n){let e=p.replace(/<img[^>]*>/g,``).trim()===``;await Promise.all([...n].map(t=>new Promise(n=>{function r(){if(t.style.display=`flex`,t.style.flexDirection=`column`,e){let e=u.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,n=parseInt(e,10)*5+`px`;t.style.minWidth=n,t.style.maxWidth=n}else t.style.width=`100%`;n(t)}a(r,`setupImage`),setTimeout(()=>{t.complete&&r()}),t.addEventListener(`error`,r),t.addEventListener(`load`,r)})))}v=e.getBoundingClientRect(),t.attr(`width`,v.width),t.attr(`height`,v.height)}else{s.includes(`font-weight: bolder`)&&o(h).selectAll(`tspan`).attr(`font-weight`,``),y=h.children.length;let e=h.children[0];(h.textContent===``||h.textContent.includes(`&gt`))&&(e.textContent=p[0]+p.substring(1).replaceAll(`&gt;`,`>`).replaceAll(`&lt;`,`<`).trim(),p[1]===` `&&(e.textContent=e.textContent[0]+` `+e.textContent.substring(1))),e.textContent===`undefined`&&(e.textContent=``),v=h.getBBox()}return c.attr(`transform`,`translate(0,`+(-v.height/(2*y)+i)+`)`),v.height}a(kn,`addText`);async function An(e,t){let n=f(),r=n.class.padding??12,i=r,a=t.useHtmlLabels??m(n.htmlLabels)??!0,s=t;s.annotations=s.annotations??[],s.members=s.members??[],s.methods=s.methods??[];let{shapeSvg:c,bbox:l}=await On(e,t,n,a,i),{labelStyles:u,nodeStyles:d}=x(t);t.labelStyle=u,t.cssStyles=s.styles||``;let p=s.styles?.join(`;`)||d||``;t.cssStyles||=p.replaceAll(`!important`,``).split(`;`);let h=s.members.length===0&&s.methods.length===0&&!n.class?.hideEmptyMembersBox,g=V.svg(c),_=b(t,{});t.look!==`handDrawn`&&(_.roughness=0,_.fillStyle=`solid`);let v=l.width,y=l.height;s.members.length===0&&s.methods.length===0?y+=i:s.members.length>0&&s.methods.length===0&&(y+=i*2);let S=-v/2,C=-y/2,w=g.rectangle(S-r,C-r-(h?r:s.members.length===0&&s.methods.length===0?-r/2:0),v+2*r,y+2*r+(h?r*2:s.members.length===0&&s.methods.length===0?-r:0),_),T=c.insert(()=>w,`:first-child`);T.attr(`class`,`basic label-container`);let E=T.node().getBBox();c.selectAll(`.text`).each((e,t,n)=>{let i=o(n[t]),l=i.attr(`transform`),u=0;if(l){let e=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(l);e&&(u=parseFloat(e[2]))}let d=u+C+r-(h?r:s.members.length===0&&s.methods.length===0?-r/2:0);a||(d-=4);let f=S;(i.attr(`class`).includes(`label-group`)||i.attr(`class`).includes(`annotation-group`))&&(f=-i.node()?.getBBox().width/2||0,c.selectAll(`text`).each(function(e,t,n){window.getComputedStyle(n[t]).textAnchor===`middle`&&(f=0)})),i.attr(`transform`,`translate(${f}, ${d})`)});let D=c.select(`.annotation-group`).node().getBBox().height-(h?r/2:0)||0,O=c.select(`.label-group`).node().getBBox().height-(h?r/2:0)||0,k=c.select(`.members-group`).node().getBBox().height-(h?r/2:0)||0;if(s.members.length>0||s.methods.length>0||h){let e=g.line(E.x,D+O+C+r,E.x+E.width,D+O+C+r,_);c.insert(()=>e).attr(`class`,`divider`).attr(`style`,p)}if(h||s.members.length>0||s.methods.length>0){let e=g.line(E.x,D+O+k+C+i*2+r,E.x+E.width,D+O+k+C+r+i*2,_);c.insert(()=>e).attr(`class`,`divider`).attr(`style`,p)}if(s.look!==`handDrawn`&&c.selectAll(`path`).attr(`style`,p),T.select(`:nth-child(2)`).attr(`style`,p),c.selectAll(`.divider`).select(`path`).attr(`style`,p),t.labelStyle?c.selectAll(`span`).attr(`style`,t.labelStyle):c.selectAll(`span`).attr(`style`,p),!a){let e=RegExp(/color\s*:\s*([^;]*)/),t=e.exec(p);if(t){let e=t[0].replace(`color`,`fill`);c.selectAll(`tspan`).attr(`style`,e)}else if(u){let t=e.exec(u);if(t){let e=t[0].replace(`color`,`fill`);c.selectAll(`tspan`).attr(`style`,e)}}}return U(t,T),t.intersect=function(e){return J.rect(t,e)},c}a(An,`classBox`);async function jn(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let i=t,a=t,s=`verifyMethod`in t,c=W(t),l=e.insert(`g`).attr(`class`,c).attr(`id`,t.domId??t.id),u;u=s?await $(l,`&lt;&lt;${i.type}&gt;&gt;`,0,t.labelStyle):await $(l,`&lt;&lt;Element&gt;&gt;`,0,t.labelStyle);let d=u,f=await $(l,i.name,d,t.labelStyle+`; font-weight: bold;`);if(d+=f+20,s){let e=await $(l,`${i.requirementId?`ID: ${i.requirementId}`:``}`,d,t.labelStyle);d+=e;let n=await $(l,`${i.text?`Text: ${i.text}`:``}`,d,t.labelStyle);d+=n;let r=await $(l,`${i.risk?`Risk: ${i.risk}`:``}`,d,t.labelStyle);d+=r,await $(l,`${i.verifyMethod?`Verification: ${i.verifyMethod}`:``}`,d,t.labelStyle)}else{let e=await $(l,`${a.type?`Type: ${a.type}`:``}`,d,t.labelStyle);d+=e,await $(l,`${a.docRef?`Doc Ref: ${a.docRef}`:``}`,d,t.labelStyle)}let p=(l.node()?.getBBox().width??200)+20,m=(l.node()?.getBBox().height??200)+20,h=-p/2,g=-m/2,_=V.svg(l),v=b(t,{});t.look!==`handDrawn`&&(v.roughness=0,v.fillStyle=`solid`);let y=_.rectangle(h,g,p,m,v),S=l.insert(()=>y,`:first-child`);if(S.attr(`class`,`basic label-container`).attr(`style`,r),l.selectAll(`.label`).each((e,t,n)=>{let r=o(n[t]),i=r.attr(`transform`),a=0,s=0;if(i){let e=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(i);e&&(a=parseFloat(e[1]),s=parseFloat(e[2]))}let c=s-m/2,l=h+20/2;(t===0||t===1)&&(l=a),r.attr(`transform`,`translate(${l}, ${c+20})`)}),d>u+f+20){let e=_.line(h,g+u+f+20,h+p,g+u+f+20,v);l.insert(()=>e).attr(`style`,r)}return U(t,S),t.intersect=function(e){return J.rect(t,e)},l}a(jn,`requirementBox`);async function $(t,r,i,a=``){if(r===``)return 0;let s=t.insert(`g`).attr(`class`,`label`).attr(`style`,a),c=f(),u=c.htmlLabels??!0,d=await _(s,l(e(r)),{width:n(r,c)+50,classes:`markdown-node-label`,useHtmlLabels:u,style:a},c),p;if(u){let e=d.children[0],t=o(d);p=e.getBoundingClientRect(),t.attr(`width`,p.width),t.attr(`height`,p.height)}else{let e=d.children[0];for(let t of e.children)t.textContent=t.textContent.replaceAll(`&gt;`,`>`).replaceAll(`&lt;`,`<`),a&&t.setAttribute(`style`,a);p=d.getBBox(),p.height+=6}return s.attr(`transform`,`translate(${-p.width/2},${-p.height/2+i})`),p.height}a($,`addText`);var Mn=a(e=>{switch(e){case`Very High`:return`red`;case`High`:return`orange`;case`Medium`:return null;case`Low`:return`blue`;case`Very Low`:return`lightblue`}},`colorFromPriority`);async function Nn(e,t,{config:n}){let{labelStyles:r,nodeStyles:i}=x(t);t.labelStyle=r||``;let a=t.width;t.width=(t.width??200)-10;let{shapeSvg:o,bbox:s,label:c}=await H(e,t,W(t)),l=t.padding||10,u=``,d;`ticket`in t&&t.ticket&&n?.kanban?.ticketBaseUrl&&(u=n?.kanban?.ticketBaseUrl.replace(`#TICKET#`,t.ticket),d=o.insert(`svg:a`,`:first-child`).attr(`class`,`kanban-ticket-link`).attr(`xlink:href`,u).attr(`target`,`_blank`));let f={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||``,width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1},p,m;d?{label:p,bbox:m}=await He(d,`ticket`in t&&t.ticket||``,f):{label:p,bbox:m}=await He(o,`ticket`in t&&t.ticket||``,f);let{label:h,bbox:g}=await He(o,`assigned`in t&&t.assigned||``,f);t.width=a;let _=t?.width||0,v=Math.max(m.height,g.height)/2,y=Math.max(s.height+20,t?.height||0)+v,S=-_/2,C=-y/2;c.attr(`transform`,`translate(`+(l-_/2)+`, `+(-v-s.height/2)+`)`),p.attr(`transform`,`translate(`+(l-_/2)+`, `+(-v+s.height/2)+`)`),h.attr(`transform`,`translate(`+(l+_/2-g.width-20)+`, `+(-v+s.height/2)+`)`);let w,{rx:T,ry:E}=t,{cssStyles:D}=t;if(t.look===`handDrawn`){let e=V.svg(o),n=b(t,{}),r=T||E?e.path(q(S,C,_,y,T||0),n):e.rectangle(S,C,_,y,n);w=o.insert(()=>r,`:first-child`),w.attr(`class`,`basic label-container`).attr(`style`,D||null)}else{w=o.insert(`rect`,`:first-child`),w.attr(`class`,`basic label-container __APA__`).attr(`style`,i).attr(`rx`,T??5).attr(`ry`,E??5).attr(`x`,S).attr(`y`,C).attr(`width`,_).attr(`height`,y);let e=`priority`in t&&t.priority;if(e){let t=o.append(`line`),n=S+2,r=C+Math.floor((T??0)/2),i=C+y-Math.floor((T??0)/2);t.attr(`x1`,n).attr(`y1`,r).attr(`x2`,n).attr(`y2`,i).attr(`stroke-width`,`4`).attr(`stroke`,Mn(e))}}return U(t,w),t.height=y,t.intersect=function(e){return J.rect(t,e)},o}a(Nn,`kanbanItem`);async function Pn(e,t){let{labelStyles:n,nodeStyles:a}=x(t);t.labelStyle=n;let{shapeSvg:o,bbox:s,halfPadding:c,label:l}=await H(e,t,W(t)),u=s.width+10*c,d=s.height+8*c,f=.15*u,{cssStyles:p}=t,m=s.width+20,h=s.height+20,g=Math.max(u,m),_=Math.max(d,h);l.attr(`transform`,`translate(${-s.width/2}, ${-s.height/2})`);let v,y=`M0 0 
    a${f},${f} 1 0,0 ${g*.25},${-1*_*.1}
    a${f},${f} 1 0,0 ${g*.25},0
    a${f},${f} 1 0,0 ${g*.25},0
    a${f},${f} 1 0,0 ${g*.25},${_*.1}

    a${f},${f} 1 0,0 ${g*.15},${_*.33}
    a${f*.8},${f*.8} 1 0,0 0,${_*.34}
    a${f},${f} 1 0,0 ${-1*g*.15},${_*.33}

    a${f},${f} 1 0,0 ${-1*g*.25},${_*.15}
    a${f},${f} 1 0,0 ${-1*g*.25},0
    a${f},${f} 1 0,0 ${-1*g*.25},0
    a${f},${f} 1 0,0 ${-1*g*.25},${-1*_*.15}

    a${f},${f} 1 0,0 ${-1*g*.1},${-1*_*.33}
    a${f*.8},${f*.8} 1 0,0 0,${-1*_*.34}
    a${f},${f} 1 0,0 ${g*.1},${-1*_*.33}
  H0 V0 Z`;if(t.look===`handDrawn`){let e=V.svg(o),n=b(t,{}),i=e.path(y,n);v=o.insert(()=>i,`:first-child`),v.attr(`class`,`basic label-container`).attr(`style`,r(p))}else v=o.insert(`path`,`:first-child`).attr(`class`,`basic label-container`).attr(`style`,a).attr(`d`,y);return v.attr(`transform`,`translate(${-g/2}, ${-_/2})`),U(t,v),t.calcIntersect=function(e,t){return J.rect(e,t)},t.intersect=function(e){return i.info(`Bang intersect`,t,e),J.rect(t,e)},o}a(Pn,`bang`);async function Fn(e,t){let{labelStyles:n,nodeStyles:a}=x(t);t.labelStyle=n;let{shapeSvg:o,bbox:s,halfPadding:c,label:l}=await H(e,t,W(t)),u=s.width+2*c,d=s.height+2*c,f=.15*u,p=.25*u,m=.35*u,h=.2*u,{cssStyles:g}=t,_,v=`M0 0 
    a${f},${f} 0 0,1 ${u*.25},${-1*u*.1}
    a${m},${m} 1 0,1 ${u*.4},${-1*u*.1}
    a${p},${p} 1 0,1 ${u*.35},${u*.2}

    a${f},${f} 1 0,1 ${u*.15},${d*.35}
    a${h},${h} 1 0,1 ${-1*u*.15},${d*.65}

    a${p},${f} 1 0,1 ${-1*u*.25},${u*.15}
    a${m},${m} 1 0,1 ${-1*u*.5},0
    a${f},${f} 1 0,1 ${-1*u*.25},${-1*u*.15}

    a${f},${f} 1 0,1 ${-1*u*.1},${-1*d*.35}
    a${h},${h} 1 0,1 ${u*.1},${-1*d*.65}
  H0 V0 Z`;if(t.look===`handDrawn`){let e=V.svg(o),n=b(t,{}),i=e.path(v,n);_=o.insert(()=>i,`:first-child`),_.attr(`class`,`basic label-container`).attr(`style`,r(g))}else _=o.insert(`path`,`:first-child`).attr(`class`,`basic label-container`).attr(`style`,a).attr(`d`,v);return l.attr(`transform`,`translate(${-s.width/2}, ${-s.height/2})`),_.attr(`transform`,`translate(${-u/2}, ${-d/2})`),U(t,_),t.calcIntersect=function(e,t){return J.rect(e,t)},t.intersect=function(e){return i.info(`Cloud intersect`,t,e),J.rect(t,e)},o}a(Fn,`cloud`);async function In(e,t){let{labelStyles:n,nodeStyles:r}=x(t);t.labelStyle=n;let{shapeSvg:i,bbox:a,halfPadding:o,label:s}=await H(e,t,W(t)),c=a.width+8*o,l=a.height+2*o,u=`
    M${-c/2} ${l/2-5}
    v${-l+10}
    q0,-5 5,-5
    h${c-10}
    q5,0 5,5
    v${l-10}
    q0,5 -5,5
    h${-c+10}
    q-5,0 -5,-5
    Z
  `,d=i.append(`path`).attr(`id`,`node-`+t.id).attr(`class`,`node-bkg node-`+t.type).attr(`style`,r).attr(`d`,u);return i.append(`line`).attr(`class`,`node-line-`).attr(`x1`,-c/2).attr(`y1`,l/2).attr(`x2`,c/2).attr(`y2`,l/2),s.attr(`transform`,`translate(${-a.width/2}, ${-a.height/2})`),i.append(()=>s.node()),U(t,d),t.calcIntersect=function(e,t){return J.rect(e,t)},t.intersect=function(e){return J.rect(t,e)},i}a(In,`defaultMindmapNode`);async function Ln(e,t){return mt(e,t,{padding:t.padding??0})}a(Ln,`mindmapCircle`);var Rn=[{semanticName:`Process`,name:`Rectangle`,shortName:`rect`,description:`Standard process shape`,aliases:[`proc`,`process`,`rectangle`],internalAliases:[`squareRect`],handler:sn},{semanticName:`Event`,name:`Rounded Rectangle`,shortName:`rounded`,description:`Represents an event`,aliases:[`event`],internalAliases:[`roundedRect`],handler:rn},{semanticName:`Terminal Point`,name:`Stadium`,shortName:`stadium`,description:`Terminal point`,aliases:[`terminal`,`pill`],handler:cn},{semanticName:`Subprocess`,name:`Framed Rectangle`,shortName:`fr-rect`,description:`Subprocess`,aliases:[`subprocess`,`subproc`,`framed-rectangle`,`subroutine`],handler:fn},{semanticName:`Database`,name:`Cylinder`,shortName:`cyl`,description:`Database storage`,aliases:[`db`,`database`,`cylinder`],handler:wt},{semanticName:`Start`,name:`Circle`,shortName:`circle`,description:`Starting point`,aliases:[`circ`],handler:mt},{semanticName:`Bang`,name:`Bang`,shortName:`bang`,description:`Bang`,aliases:[`bang`],handler:Pn},{semanticName:`Cloud`,name:`Cloud`,shortName:`cloud`,description:`cloud`,aliases:[`cloud`],handler:Fn},{semanticName:`Decision`,name:`Diamond`,shortName:`diam`,description:`Decision-making step`,aliases:[`decision`,`diamond`,`question`],handler:$t},{semanticName:`Prepare Conditional`,name:`Hexagon`,shortName:`hex`,description:`Preparation or condition step`,aliases:[`hexagon`,`prepare`],handler:jt},{semanticName:`Data Input/Output`,name:`Lean Right`,shortName:`lean-r`,description:`Represents input or output`,aliases:[`lean-right`,`in-out`],internalAliases:[`lean_right`],handler:Ht},{semanticName:`Data Input/Output`,name:`Lean Left`,shortName:`lean-l`,description:`Represents output or input`,aliases:[`lean-left`,`out-in`],internalAliases:[`lean_left`],handler:Vt},{semanticName:`Priority Action`,name:`Trapezoid Base Bottom`,shortName:`trap-b`,description:`Priority action`,aliases:[`priority`,`trapezoid-bottom`,`trapezoid`],handler:bn},{semanticName:`Manual Operation`,name:`Trapezoid Base Top`,shortName:`trap-t`,description:`Represents a manual task`,aliases:[`manual`,`trapezoid-top`,`inv-trapezoid`],internalAliases:[`inv_trapezoid`],handler:Rt},{semanticName:`Stop`,name:`Double Circle`,shortName:`dbl-circ`,description:`Represents a stop point`,aliases:[`double-circle`],internalAliases:[`doublecircle`],handler:Et},{semanticName:`Text Block`,name:`Text Block`,shortName:`text`,description:`Text block`,handler:hn},{semanticName:`Card`,name:`Notched Rectangle`,shortName:`notch-rect`,description:`Represents a card`,aliases:[`card`,`notched-rectangle`],handler:ft},{semanticName:`Lined/Shaded Process`,name:`Lined Rectangle`,shortName:`lin-rect`,description:`Lined process shape`,aliases:[`lined-rectangle`,`lined-process`,`lin-proc`,`shaded-process`],handler:an},{semanticName:`Start`,name:`Small Circle`,shortName:`sm-circ`,description:`Small starting point`,aliases:[`start`,`small-circle`],internalAliases:[`stateStart`],handler:dn},{semanticName:`Stop`,name:`Framed Circle`,shortName:`fr-circ`,description:`Stop point`,aliases:[`stop`,`framed-circle`],internalAliases:[`stateEnd`],handler:un},{semanticName:`Fork/Join`,name:`Filled Rectangle`,shortName:`fork`,description:`Fork or join in process flow`,aliases:[`join`],internalAliases:[`forkJoin`],handler:kt},{semanticName:`Collate`,name:`Hourglass`,shortName:`hourglass`,description:`Represents a collate operation`,aliases:[`hourglass`,`collate`],handler:Mt},{semanticName:`Comment`,name:`Curly Brace`,shortName:`brace`,description:`Adds a comment`,aliases:[`comment`,`brace-l`],handler:_t},{semanticName:`Comment Right`,name:`Curly Brace`,shortName:`brace-r`,description:`Adds a comment`,handler:vt},{semanticName:`Comment with braces on both sides`,name:`Curly Braces`,shortName:`braces`,description:`Adds a comment`,handler:yt},{semanticName:`Com Link`,name:`Lightning Bolt`,shortName:`bolt`,description:`Communication link`,aliases:[`com-link`,`lightning-bolt`],handler:Ut},{semanticName:`Document`,name:`Document`,shortName:`doc`,description:`Represents a document`,aliases:[`doc`,`document`],handler:Cn},{semanticName:`Delay`,name:`Half-Rounded Rectangle`,shortName:`delay`,description:`Represents a delay`,aliases:[`half-rounded-rectangle`],handler:At},{semanticName:`Direct Access Storage`,name:`Horizontal Cylinder`,shortName:`h-cyl`,description:`Direct access storage`,aliases:[`das`,`horizontal-cylinder`],handler:yn},{semanticName:`Disk Storage`,name:`Lined Cylinder`,shortName:`lin-cyl`,description:`Disk storage`,aliases:[`disk`,`lined-cylinder`],handler:qt},{semanticName:`Display`,name:`Curved Trapezoid`,shortName:`curv-trap`,description:`Represents a display`,aliases:[`curved-trapezoid`,`display`],handler:bt},{semanticName:`Divided Process`,name:`Divided Rectangle`,shortName:`div-rect`,description:`Divided process shape`,aliases:[`div-proc`,`divided-rectangle`,`divided-process`],handler:Tt},{semanticName:`Extract`,name:`Triangle`,shortName:`tri`,description:`Extraction process`,aliases:[`extract`,`triangle`],handler:Sn},{semanticName:`Internal Storage`,name:`Window Pane`,shortName:`win-pane`,description:`Internal storage`,aliases:[`internal-storage`,`window-pane`],handler:Tn},{semanticName:`Junction`,name:`Filled Circle`,shortName:`f-circ`,description:`Junction point`,aliases:[`junction`,`filled-circle`],handler:Dt},{semanticName:`Loop Limit`,name:`Trapezoidal Pentagon`,shortName:`notch-pent`,description:`Loop limit step`,aliases:[`loop-limit`,`notched-pentagon`],handler:xn},{semanticName:`Manual File`,name:`Flipped Triangle`,shortName:`flip-tri`,description:`Manual file operation`,aliases:[`manual-file`,`flipped-triangle`],handler:Ot},{semanticName:`Manual Input`,name:`Sloped Rectangle`,shortName:`sl-rect`,description:`Manual input step`,aliases:[`manual-input`,`sloped-rectangle`],handler:on},{semanticName:`Multi-Document`,name:`Stacked Document`,shortName:`docs`,description:`Multiple documents`,aliases:[`documents`,`st-doc`,`stacked-document`],handler:Xt},{semanticName:`Multi-Process`,name:`Stacked Rectangle`,shortName:`st-rect`,description:`Multiple processes`,aliases:[`procs`,`processes`,`stacked-rectangle`],handler:Yt},{semanticName:`Stored Data`,name:`Bow Tie Rectangle`,shortName:`bow-rect`,description:`Stored data`,aliases:[`stored-data`,`bow-tie-rectangle`],handler:dt},{semanticName:`Summary`,name:`Crossed Circle`,shortName:`cross-circ`,description:`Summary`,aliases:[`summary`,`crossed-circle`],handler:gt},{semanticName:`Tagged Document`,name:`Tagged Document`,shortName:`tag-doc`,description:`Tagged document`,aliases:[`tag-doc`,`tagged-document`],handler:mn},{semanticName:`Tagged Process`,name:`Tagged Rectangle`,shortName:`tag-rect`,description:`Tagged process`,aliases:[`tagged-rectangle`,`tag-proc`,`tagged-process`],handler:pn},{semanticName:`Paper Tape`,name:`Flag`,shortName:`flag`,description:`Paper tape`,aliases:[`paper-tape`],handler:wn},{semanticName:`Odd`,name:`Odd`,shortName:`odd`,description:`Odd shape`,internalAliases:[`rect_left_inv_arrow`],handler:en},{semanticName:`Lined Document`,name:`Lined Document`,shortName:`lin-doc`,description:`Lined document`,aliases:[`lined-document`],handler:Jt}],zn=a(()=>{let e={state:ln,choice:pt,note:Zt,rectWithTitle:tn,labelRect:Bt,iconSquare:It,iconCircle:Pt,icon:Nt,iconRounded:Ft,imageSquare:Lt,anchor:lt,kanbanItem:Nn,mindmapCircle:Ln,defaultMindmapNode:In,classBox:An,erBox:En,requirementBox:jn},t=[...Object.entries(e),...Rn.flatMap(e=>[e.shortName,...`aliases`in e?e.aliases:[],...`internalAliases`in e?e.internalAliases:[]].map(t=>[t,e.handler]))];return Object.fromEntries(t)},`generateShapeMap`)();function Bn(e){return e in zn}a(Bn,`isValidShape`);var Vn=new Map;async function Hn(e,t,n){let r,i;t.shape===`rect`&&(t.rx&&t.ry?t.shape=`roundedRect`:t.shape=`squareRect`);let a=t.shape?zn[t.shape]:void 0;if(!a)throw Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let o;n.config.securityLevel===`sandbox`?o=`_top`:t.linkTarget&&(o=t.linkTarget||`_blank`),r=e.insert(`svg:a`).attr(`xlink:href`,t.link).attr(`target`,o??null),i=await a(r,t,n)}else i=await a(e,t,n),r=i;return t.tooltip&&i.attr(`title`,t.tooltip),Vn.set(t.id,r),t.haveCallback&&r.attr(`class`,r.attr(`class`)+` clickable`),r}a(Hn,`insertNode`);var Un=a((e,t)=>{Vn.set(t.id,e)},`setNodeElem`),Wn=a(()=>{Vn.clear()},`clear`),Gn=a(e=>{let t=Vn.get(e.id);i.trace(`Transforming node`,e.diff,e,`translate(`+(e.x-e.width/2-5)+`, `+e.width/2+`)`);let n=e.diff||0;return e.clusterNode?t.attr(`transform`,`translate(`+(e.x+n-e.width/2)+`, `+(e.y-e.height/2-8)+`)`):t.attr(`transform`,`translate(`+e.x+`, `+e.y+`)`),n},`positionNode`);export{Hn as a,Gn as c,V as d,Ze as i,Un as l,Wn as n,Bn as o,qe as r,H as s,Qe as t,U as u};